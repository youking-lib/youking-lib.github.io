<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://youking.vsh.cc</id>
    <title>Youking</title>
    <updated>2025-02-20T10:54:36.036Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://youking.vsh.cc"/>
    <link rel="self" href="https://youking.vsh.cc/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://youking.vsh.cc/images/avatar.png</logo>
    <icon>https://youking.vsh.cc/favicon.ico</icon>
    <rights>All rights reserved 2025, Youking</rights>
    <entry>
        <title type="html"><![CDATA[ç‹¬ç«‹å¼€å‘æŠ€æœ¯æ ˆ  2024 å¹´åº¦æ€»ç»“]]></title>
        <id>https://youking.vsh.cc/post/useful-technology-stack-snippet/</id>
        <link href="https://youking.vsh.cc/post/useful-technology-stack-snippet/">
        </link>
        <updated>2024-12-27T06:41:17.000Z</updated>
        <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>ä½ æœ‰æ²¡æœ‰é‚£ä¹ˆä¸€å¤©çªç„¶çµå…‰ä¸€ç°ï¼Œè„‘æµ·é‡Œå‡ºç°ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„ Ideaï¼Œå¹¶ä¸”æƒ³è¦å°†å®ƒå®ç°å‡ºæ¥ï¼›</p>
<p>ç„¶åä½ æ»¡æ€€æ¿€æƒ…çš„ç­¹å¤‡æ—¶ï¼Œå´å‘ç°è¿™ä¸ªè¿‡ç¨‹å¹¶ä¸é¡ºåˆ©ã€‚é¦–å½“å…¶å†²çš„å°±æ˜¯æ‰‹å¤´æ²¡æœ‰è¶æ‰‹çš„å·¥å…·ï¼Œæˆ–æ˜¯<br>
èŠ±è´¹å¤§é‡æ—¶é—´å­¦ä¹ æ–°å·¥å…·ï¼Œå´é‡åˆ°å„ç§å„æ ·çš„éš¾ç‚¹å’Œå‘ç‚¹ï¼›</p>
<p>äºæ˜¯è¿™ä¸ª Idea å°±è¢«æç½®ï¼Œåƒæ˜¯æ©åŸ‹åœ¨å°˜åŸƒé‡Œçš„ä¸€é¢—ç§å­...</p>
<p>ä»¥ä¸Šæ˜¯ç¬”è€…æ›¾ç» â€œæ— æ•°æ¬¡æˆä¸ºç‹¬ç«‹å¼€å‘è€…â€ çš„å¿ƒè·¯å†ç¨‹ï¼Œå› æ­¤æœ¬æ–‡è®°å½•ä¸€ä¸‹è¿ˆè¿‡è¿™ä¸ªé˜¶æ®µä¹‹åçš„æ€»ç»“ä¸æ²‰æ·€ã€‚</p>
<h2 id="å¦‚ä½•é€‰æ‹©é€‚åˆè‡ªå·±çš„æŠ€æœ¯æ ˆ">å¦‚ä½•é€‰æ‹©é€‚åˆè‡ªå·±çš„æŠ€æœ¯æ ˆï¼Ÿ</h2>
<p>å‚è€ƒä»¥ä¸‹å‡ ä¸ªè§’åº¦ï¼š</p>
<ul>
<li>æŠ€æœ¯é€‰å‹çš„ç›®çš„æˆ–åŸåˆ™æ˜¯é™æœ¬ææ•ˆï¼Œè„±ç¦»è¿™ä¸ªåŸåˆ™çš„é€‰å‹éƒ½æ˜¯ä¸è´Ÿè´£ä»»çš„ï¼›</li>
<li>ä»è‡ªèº«è§’åº¦é€‰æ‹©è‡ªå·±æœ€ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆï¼Œå‡å°‘å­¦ä¹ æˆæœ¬ã€æ—¶é—´æˆæœ¬ï¼Œèšç„¦äºå¿«é€Ÿå®ç°äº§å“åŠŸèƒ½ï¼›</li>
<li>ä»ç¤¾åŒºè§’åº¦é€‰å–æˆç†Ÿç¨³å®šçš„äº§å“æœåŠ¡ï¼Œé€‰æ‹©æˆæœ¬è¾ƒä½çš„æ–¹æ¡ˆï¼›</li>
</ul>
<p>æ—¶é—´å’Œé’±æ˜¯æœ€å¤§çš„æˆæœ¬ï¼Œä»¥ä¸‹æ˜¯å‡ ä¸ªåä¾‹ï¼š</p>
<ul>
<li>äº§å“è¿˜æ²¡å‘å¸ƒä¸Šçº¿ï¼Œå·²ç»é‡æ„äº†å¥½å‡ éï¼›</li>
<li>è¿˜æ²¡å®ç°åŠŸèƒ½ï¼Œå…ˆä¹°äº†ä¸€å †åŸŸåï¼›</li>
<li>äº§å“æ²¡æœ‰å‡ ä¸ªç”¨æˆ·å·²ç»è€ƒè™‘ä¼˜åŒ–æè‡´çš„ç½‘ç»œä½“éªŒï¼›</li>
</ul>
<p>ç¬”è€…ä¹Ÿæ˜¯è¸©äº†å¾ˆå¤šå‘æ‰æ€»ç»“å‡ºä¸€å¥—å½“ä¸‹è‡ªå·±è¶æ‰‹çš„å·¥å…·ï¼Œåç»­ä¹Ÿä¼šæŒç»­æ›´æ–°ï¼Œæ¯•ç«Ÿè¿™åªæ˜¯å½“ä¸‹çš„æ•™è®­åæ€ï¼Œçœ‹ä¼¼å®Œç¾çš„å·¥å…·ç½¢äº† ğŸ¤¡ã€‚</p>
<h2 id="æ•´ä½“æ–¹æ¡ˆ">æ•´ä½“æ–¹æ¡ˆ</h2>
<p>å‰ç«¯</p>
<ul>
<li>æ¡†æ¶ï¼š<a href="https://react.dev/">React</a></li>
<li>æ‰“åŒ…ç¼–è¯‘ï¼š<a href="https://nextjs.org/docs">Nextjs</a>ã€<a href="https://tsup.egoist.dev/#install">tsup</a></li>
<li>åŒ…ç®¡ç†ï¼š<a href="https://pnpm.io/installation">pnpm</a>ã€<a href="https://turbo.build/repo/docs">turbo</a></li>
<li>UIï¼š <a href="https://www.radix-ui.com/themes/docs/overview/getting-started">@radix-ui</a>ã€<a href="https://tailwindcss.com/docs/installation">tailwind</a>ã€<a href="https://ui.shadcn.com/">shacn-ui</a></li>
<li>çŠ¶æ€ç®¡ç†ï¼š<a href="https://immerjs.github.io/immer/zh-CN/example-setstate">use-immer</a></li>
</ul>
<p>åç«¯ï¼š</p>
<ul>
<li>æ¡†æ¶ï¼š<a href="https://hono.dev/docs/getting-started/basic">Honojs</a>ã€<a href="https://nextjs.org/docs">Nextjs</a></li>
<li>OpenAPIï¼š@hono/zod-openapiã€@hono/swagger-uiã€swagger-typescript-apiï¼ˆTS æ¥å£æ–‡ä»¶ç”Ÿæˆï¼‰ï¼Œ<a href="https://youking-lib.github.io/post/honojs-zod-openapi/">æŸ¥çœ‹æ–¹æ¡ˆ OpenAPI å®ç°æ–¹æ¡ˆ</a></li>
<li>æ•°æ®åº“ï¼š<a href="https://www.prisma.io/docs/orm/overview/introduction/what-is-prisma">Prisma</a>ã€<a href="https://developers.cloudflare.com/d1/">Cloudflare D1</a></li>
<li>é‚®ä»¶
<ul>
<li>å›½å¤–ï¼š<a href="https://www.useplunk.com/">Plunkï¼ˆå¼€æºï¼‰</a>ã€<a href="https://resend.com/">Resend</a></li>
<li>å›½å†…ï¼šé£ä¹¦é‚®ä»¶ + <a href="https://www.nodemailer.com/">nodemailer</a> + <a href="https://react.email/docs/introduction">react-emailï¼ˆé‚®ä»¶æ¨¡ç‰ˆï¼‰</a></li>
</ul>
</li>
<li>ç»Ÿè®¡ï¼š<a href="https://umami.is/">umamiï¼ˆå¼€æºï¼‰</a>ã€<a href="https://marketingplatform.google.com/about/analytics/">Google Analytics</a></li>
<li>é‰´æƒï¼š<a href="https://clerk.com/">Clerk SAAS</a>ã€<a href="https://www.npmjs.com/package/jose">jose JWT</a></li>
</ul>
<p>AIï¼š</p>
<ul>
<li>SDKï¼š<a href="https://sdk.vercel.ai/docs/introduction">Vercel AI SDK</a></li>
<li>Providerï¼š<a href="https://azure.microsoft.com/en-us/pricing/details/cognitive-services/openai-service/#pricing">Azure OpenAI</a>ã€<a href="https://developers.cloudflare.com/workers-ai/">Cloudflare AI</a>ã€<a href="https://help.aliyun.com/zh/model-studio/getting-started/what-is-model-studio?spm=5176.29619931.J_AHgvE-XDhTWrtotIBlDQQ.13.7efa59fceyn3Vq#1a407ae2caj33">Ali é€šä¹‰ï¼ˆå›½å†…ï¼‰</a></li>
<li>Vector DBï¼š<a href="https://developers.cloudflare.com/vectorize/">Cloudlfare Vector</a>ã€<a href="https://milvus.io/docs/architecture_overview.md">Milvus</a></li>
</ul>
<p>è¿ç»´ï¼š</p>
<ul>
<li>éƒ¨ç½²ï¼š<a href="https://developers.cloudflare.com/pages/">Cloudlare Worker/Pages</a>ã€<a href="https://pm2.keymetrics.io/docs/usage/quick-start/">PM2</a>ã€<a href="https://docs.docker.com/engine/install/">Docker</a></li>
<li>HTTPSï¼š<a href="https://caddyserver.com/docs/install">Caddy</a></li>
<li>åŸŸå DNSï¼š<a href="https://www.cloudflare.com/">Cloudlfare</a></li>
</ul>
<blockquote>
<p>åŸºäºæˆæœ¬è€ƒé‡ï¼ŒæœåŠ¡éƒ¨ç½²é¦–é€‰ Cloudflare Workerï¼Œå¦‚å—é™äºæŠ€æœ¯é—®é¢˜ Worker æ— æ³•æ”¯æŒï¼Œå¯ä»¥é€‰æ‹©ä¸€ä¸ªä½æˆæœ¬çš„æœåŠ¡å™¨ï¼Œç”¨äºéƒ¨ç½² PM2ã€Docker ç­‰æœåŠ¡</p>
</blockquote>
<p>Docker æœåŠ¡ï¼Œå‚è€ƒ <a href="https://youking-lib.github.io/post/usefull-docker-compose-configs/">ä½¿ç”¨ Docker Compose å¿«é€Ÿéƒ¨ç½²å¸¸ç”¨çš„æœåŠ¡</a></p>
<ul>
<li>[SAAS] Dify https://dify.ai/</li>
<li>[SAAS] Umami https://umami.is/</li>
<li>[SAAS] Flowise AI https://flowiseai.com/</li>
<li>[SAAS] Firecrawl çˆ¬è™«  https://www.firecrawl.dev/</li>
<li>[æ•°æ®åº“] Mysql</li>
<li>[æ•°æ®åº“] MongoDB</li>
<li>[æ•°æ®åº“] Milvus</li>
<li>[æ•°æ®åº“] Neo4j</li>
<li>[ä¸­é—´ä»¶] Kafka</li>
</ul>
<p>Common Packageï¼š</p>
<ul>
<li><a href="https://zod.dev/">zodjs</a>ï¼šæ•°æ®æ ¡éªŒã€TS ç±»å‹æ¨å¯¼ï¼›</li>
<li><a href="https://tsx.is/">tsx</a>ï¼šç›´æ¥è¿è¡Œ ts/tsx æ–‡ä»¶ï¼Œå¿«é€Ÿ debugï¼›</li>
<li><a href="https://vitest.dev/">vitest</a>ï¼šå•å…ƒæµ‹è¯•æ¡†æ¶ jest çš„å®Œç¾æ›¿ä»£ ï¼Œå†ä¹Ÿä¸ç”¨å…³å¿ƒ ES æ¨¡å—ä¸ TS ç¼–è¯‘é—®é¢˜ï¼›</li>
<li><a href="https://github.com/ai/nanoid">nanoid</a>ï¼šUUID ç”Ÿæˆï¼›</li>
</ul>
<h2 id="å‰ç«¯">å‰ç«¯</h2>
<h3 id="åŸºäº-trubo-pnpm-nextjs-tsup-çš„å¤šåŒ…æ–¹æ¡ˆ">åŸºäº truboã€pnpmã€nextjsã€tsup çš„å¤šåŒ…æ–¹æ¡ˆ</h3>
<p>ä¸€æ•´å¹´ä¸‹æ¥ï¼Œæœ€è¶æ‰‹çš„å°±æ˜¯è¯¥å¤šåŒ…æ–¹æ¡ˆï¼š</p>
<ul>
<li>ä½¿ç”¨ <a href="https://turbo.build/repo/docs">turbo</a> è‡ªåŠ¨çš„è¿›è¡Œä¾èµ–ä»»åŠ¡æ„å»ºï¼›</li>
<li>ä½¿ç”¨ <a href="https://pnpm.io/installation">pnpm</a> å¿«é€Ÿé«˜æ•ˆçš„é“¾æ¥å¤šä¸ª Pakcageï¼›</li>
<li>ä½¿ç”¨ <a href="https://nextjs.org/docs">Nextjs</a> æå‡å…¨æ–¹é¢æå‡ React å¼€å‘ä½“éªŒï¼Œå¹¶æä¾›è½»é‡çº§çš„ API æœåŠ¡ï¼›</li>
<li>ä½¿ç”¨ <a href="https://tsup.egoist.dev/#install">tsup</a> å¤„ç†ç‰¹æ®Šåœºæ™¯çš„æ‰“åŒ…æ„å»ºï¼Œå¦‚æ„å»ºç¬¦åˆ commonjs è§„èŒƒçš„åŒ…ï¼ˆPackageï¼‰ã€æ‰“åŒ…æ–‡ä»¶ï¼ˆBundle Fileï¼‰ï¼›</li>
</ul>
<p>å‚è€ƒ <a href="https://youking-lib.github.io/post/turbo-monorepo-buffet/">åŸºäº truboã€pnpmã€nextjsã€tsup çš„ monorepo æ”¾é¢˜</a> æ·±å…¥äº†è§£ã€‚</p>
<h3 id="ui-åº“çš„æœ€ä½³å®è·µ">UI åº“çš„æœ€ä½³å®è·µ</h3>
<p>UI åº“çš„é€‰å‹ä¼˜å…ˆé€‰æ‹©è‡ªå·±æœ€ç†Ÿæ‚‰æ“…é•¿çš„è½®å­ï¼Œå¦‚æœæƒ³æƒ³è¦å°é²œæˆ–çªç ´ï¼Œå¯å‚è€ƒä»¥ä¸‹é€‰å‹ï¼š</p>
<ul>
<li>é¦–é€‰ <a href="https://www.radix-ui.com/themes/docs/overview/getting-started">@radix-ui</a> ä¸éœ€è¦é¢å¤–é…ç½®ï¼Œå®‰è£…åŒ…åç›´æ¥ä½¿ç”¨ï¼›</li>
<li>å¯¹äºè¾ƒä¸ºå¤æ‚çš„æ’ç‰ˆåœºæ™¯ã€AI ç”Ÿæˆçš„ä»£ç æ¨¡ç‰ˆï¼Œä½¿ç”¨ <a href="https://tailwindcss.com/docs/installation">tailwind</a>ï¼›</li>
<li>@radix-ui æä¾›çš„ç»„ä»¶å¹¶ä¸ç®—ä¸°å¯Œï¼Œè¿˜å¯ä»¥é€‰æ‹© <a href="https://ui.shadcn.com/">shacn-ui</a>ã€<a href="https://www.chakra-ui.com/">chakraui</a> ç­‰</li>
</ul>
<p>ç»å¤§éƒ¨åˆ†åœºæ™¯å¯ä»¥ç›´æ¥ä½¿ç”¨ @radix-ui ç»„ä»¶æä¾›çš„ props è¿›è¡Œæ’ç‰ˆï¼š</p>
<pre><code class="language-typescript">function RadixUI() {
    return (
        &lt;Flex mt=&quot;2&quot;&gt;&lt;Flex&gt;
    )
}

function TailwindUI() {
    return (
        &lt;div className=&quot;flex mt-2&quot;&gt;&lt;/div&gt;
    )
}
</code></pre>
<p>å‚è€ƒï¼š</p>
<ul>
<li><a href="https://github.com/radix-ui/themes/issues/109#issuecomment-1747345743">@radix-ui ä¸ tailwind ç»„åˆä½¿ç”¨</a></li>
</ul>
<h3 id="å²ä¸Šæœ€ç®€å•é«˜æ•ˆçš„çŠ¶æ€ç®¡ç†">å²ä¸Šæœ€ç®€å•é«˜æ•ˆçš„çŠ¶æ€ç®¡ç†</h3>
<p>åœ¨ Nextjs ç¯å¢ƒä¸­ï¼Œå®Œå…¨è„±ç¦»çŠ¶æ€ç®¡ç†åº“ï¼ˆSWRã€Server Action ç­‰æ–¹æ¡ˆï¼‰åˆä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œè€Œå¼•å…¥ zustandã€redux ç­‰åº“åˆå¤ªé‡ã€‚</p>
<p>ä½¿ç”¨ user-immer æ¸è¿›å¼çš„è§£å†³ç®€å•ç»„ä»¶å†…éƒ¨çŠ¶æ€ç®¡ç†ã€å¤æ‚çš„ä¸šåŠ¡ç»„ä»¶çŠ¶æ€ç®¡ç†ï¼Œç”šè‡³æ˜¯æ•´ä¸ªåº”ç”¨çš„çŠ¶æ€ç®¡ç†ï¼Œä¼˜åŠ¿å¦‚ä¸‹ï¼š</p>
<ul>
<li>[æ¥è¿‘åŸç”Ÿ JS çš„å¼€å‘ä½“éªŒ] ä½¿ç”¨æ¥è¿‘ js åŸç”Ÿå¯¹è±¡çš„é£æ ¼æ“ä½œä¸å¯å˜æ•°æ®ï¼Œå¼•å…¥çš„æ¦‚å¿µå°‘ï¼›</li>
<li>[ä¸ React æ— ç¼ç»“åˆ] ä¸ react ç»“åˆï¼ŒçŠ¶æ€å˜æ›´å¯é¢„æµ‹ï¼Œè°ƒè¯•å‹å¥½ï¼Œdiff å˜æ›´æ—¶ä¸ä¼šé€ æˆå¿ƒæ™ºè´Ÿæ‹…ï¼›</li>
<li>[çµæ´»æ‹“å±•] æŒ‰éœ€æ‹“å±•åœºæ™¯ï¼Œå¦‚ Selectorã€Mutation ç­‰ï¼ŒçŠ¶æ€æµè½¬ç™½ç›’åŒ–ï¼›</li>
</ul>
<p>ä½“éªŒç¤ºä¾‹å¦‚ä¸‹ï¼Œå¯ä»¥å‚è€ƒ <a href="https://youking-lib.github.io/post/use-immer-state-manager/">å²ä¸Šæœ€ç®€å•é«˜æ•ˆçš„çŠ¶æ€ç®¡ç†<br>
</a> äº†è§£æ›´å¤šï¼š</p>
<pre><code class="language-typescript">function Lists() {
    const posts = useSelector(getPosts);
    const dispatch = useDispatch();

    useEffect(() =&gt; {
        getAllPosts().then(posts =&gt; {
            dispatch(draft =&gt; setPosts(draft, posts))
        })
    }, [])
}
</code></pre>
<h2 id="åç«¯">åç«¯</h2>
<h3 id="æ„å»ºç±»å‹å®‰å…¨çš„-api-æ¥å£-openapi-è‡ªåŠ¨æˆ-ts-æ¥å£æ–‡ä»¶">æ„å»ºç±»å‹å®‰å…¨çš„ API æ¥å£ - OpenAPI è‡ªåŠ¨æˆ TS æ¥å£æ–‡ä»¶</h3>
<ol>
<li>æ–¹æ¡ˆ</li>
</ol>
<ul>
<li><a href="https://hono.dev/docs/getting-started/basic">Honojs</a> è½»é‡æœåŠ¡æ¡†æ¶ï¼Œæ”¯æŒè¿è¡Œåœ¨å„ç§å¹³å°ï¼Œå¦‚ Cloudflare Workerã€Vercelï¼Œæ”¯æŒé›†æˆåˆ° Nextjsï¼›</li>
<li><a href="https://hono.dev/examples/zod-openapi">@hono/zod-openapi</a> åŸºäº Zodjs å®šä¹‰ Swagger æ¥å£</li>
<li><a href="https://hono.dev/examples/swagger-ui">@hono/swagger-ui</a> ç”Ÿæˆ Swagger æ¥å£æ–‡æ¡£</li>
<li><a href="https://github.com/acacode/swagger-typescript-api">swagger-typescript-api</a> ç”Ÿæˆ ts æ¥å£æ–‡ä»¶</li>
</ul>
<ol start="2">
<li>ä¼˜åŠ¿</li>
</ol>
<ul>
<li>è¾“å‡ºè§„èŒƒçš„ Swagger æ¥å£æ–‡æ¡£ï¼Œæ”¯æŒä»£ç ç”Ÿæˆï¼›</li>
<li>åŸºäº zodjs ç”Ÿæˆçš„ schemaï¼Œè‡ªåŠ¨çš„æ•°æ®æ ¡éªŒä¸ç±»å‹æ¨å¯¼ï¼›</li>
<li>åŸºäºè½»é‡çº§çš„ Honojs æ¡†æ¶ï¼Œç›¸åŒçš„ä»£ç æ”¯æŒåœ¨æ‰€æœ‰å¹³å°è¿è¡Œï¼›</li>
</ul>
<p>å‚è€ƒ <a href="https://youking-lib.github.io/post/honojs-zod-openapi/">æ„å»ºç±»å‹å®‰å…¨çš„ API æ¥å£ - OpenAPI è‡ªåŠ¨æˆ TS æ¥å£æ–‡ä»¶</a> äº†è§£å…·ä½“å®ç°</p>
<h3 id="orm-ä¸ºä»€ä¹ˆé€‰æ‹©-prisma">ORM ä¸ºä»€ä¹ˆé€‰æ‹© Prismaï¼Ÿ</h3>
<p>prisma çš„ä¼˜åŠ¿å¦‚ä¸‹ï¼š</p>
<ol>
<li>åŸºäºé¢å‘å¯¹è±¡çš„æŸ¥è¯¢æ¥å£ï¼Œçµæ´»ä¸”æµç•…ï¼ŒTS ç±»å‹æ¨å¯¼éå¸¸ä¸¥è°¨å®‰å…¨ï¼›</li>
<li>æ”¯æŒå¤šç§æ•°æ®åº“ï¼Œå¦‚ MySQLã€PostgreSQLã€CloudFlare D1ã€MongoDB ç­‰ï¼Œå®Œç¾é€‚åº”ä¸åŒå›¢é˜Ÿã€é¡¹ç›®çš„é€‰å‹åå¥½ï¼Œå³ä½¿ä½ æ²¡æœ‰ SQL è¯­æ³•çš„ä½¿ç”¨ç»éªŒï¼›</li>
<li>æ¸…æ™°çš„æ•°æ®æ¨¡å‹å®šä¹‰ DSLã€å®Œæ•´çš„è¿ç§»åŒæ­¥å·¥å…·ã€ä¸°å¯Œçš„æ–‡æ¡£ä¸å¼ºå¤§çš„ç¤¾åŒºï¼›</li>
<li>æ”¯æŒ Cloudflare D1ï¼</li>
</ol>
<p>ä»¥ä¸‹æ˜¯ Prisma çš„ä½¿ç”¨åœºæ™¯ï¼Œæ„Ÿå—ä¸€ä¸‹ Prisma çš„ä¾¿æ·æ€§ï¼š</p>
<ol>
<li>å…³è”æ•°æ®åˆ›å»ºåœºæ™¯ï¼šåˆå§‹åŒ–é¡¹ç›®ä»¥åŠé¡¹ç›®çš„ç®¡ç†å‘˜</li>
</ol>
<pre><code class="language-typescript">const project = await prisma.project.create({
    data: {
        title: 'default project',
        owner: {
            create: {
                username: 'ç®¡ç†å‘˜'
            }
        }
    }
})
</code></pre>
<ol start="2">
<li>å…³è”æŸ¥è¯¢åœºæ™¯ï¼šæŸ¥è¯¢é¡¹ç›®è¯¦æƒ…å¹¶å…³è”å‡ºç®¡ç†å‘˜ä¿¡æ¯</li>
</ol>
<pre><code class="language-typescript">// å…³è”æŸ¥è¯¢
function getProject(id: string) {
    return prisma.project.findUnique({
        where: {
            id
        },
        include: {
            owner: true,
        }
    })
}
</code></pre>
<p>Prisma è¿˜æ”¯æŒ Cloudflare D1 ä»¥åŠ è‡ªåŠ¨ç”Ÿæˆ zodjs æ–‡ä»¶ï¼Œå‚è€ƒè¿™ç¯‡æ–‡ç«  <a href="https://youking-lib.github.io/post/prisma-guide/">ORM ä¸ºä»€ä¹ˆé€‰æ‹© Prismajs</a></p>
<h3 id="é›¶æˆæœ¬å®šåˆ¶é‚®ä»¶æ¨¡å—">é›¶æˆæœ¬å®šåˆ¶é‚®ä»¶æ¨¡å—</h3>
<p>æœ‰ä¸¤ç§å¸¸ç”¨é‚®ä»¶å‘é€çš„æ–¹å¼ï¼š</p>
<ol>
<li>åŸŸåè§£æåˆ°é‚®ä»¶ Saas æœåŠ¡ï¼Œå¦‚ <a href="https://resend.com/">Resend</a>ã€<a href="https://www.useplunk.com/">Plunk</a> ç­‰ï¼Œæ¨è Plunkï¼Œå¼€æºä¸”æ”¯æŒç‹¬ç«‹éƒ¨ç½²ï¼›</li>
<li>SMTP + nodemailer</li>
</ol>
<p>ç¬”è€…ä½¿ç”¨çš„æ˜¯æ–¹å¼äºŒï¼Œå› ä¸ºå·²ç»å°†é‚®ä»¶æ‰˜ç®¡åˆ°äº†é£ä¹¦ï¼Œé€‰æ‹©è‡ªå·±å†™äº†ä¸€ä¸ªç‹¬ç«‹çš„é‚®ä»¶ OpenAPI æœåŠ¡ï¼Œå‚è€ƒ <a href="https://youking-lib.github.io/post/send-email/">ç»“åˆ react-email é›¶æˆæœ¬å®šåˆ¶é‚®ä»¶ç³»ç»Ÿ</a></p>
<h3 id="ai-æ¯”-langchainjs-æ›´å¥½ç”¨çš„-ai-sdk">[AI] æ¯” langchainjs æ›´å¥½ç”¨çš„ AI SDK</h3>
<p>å¦‚æœæ·±å…¥ç”¨è¿‡çš„ langchainjs çš„è¯ï¼Œä½ è‚¯å®šä¹Ÿä¼šéª‚å®ƒå¾ˆå¤šéï¼Œå¾ˆå¤šåŒ…ä¸é¢å‘æºä»£ç ç¼–ç¨‹ï¼Œæ˜¯è·‘ä¸èµ·æ¥çš„ï¼Œå› æ­¤åªé€‚åˆå‚è€ƒå®ç°é€»è¾‘ï¼›</p>
<p>ä½“éªŒæœ€å¥½çš„æ˜¯ Vercel å®¶çš„ <a href="https://sdk.vercel.ai/docs/introduction">SDK</a>ï¼Œä¼˜åŠ¿å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ”¯æŒä¸åŒçš„æ¨¡å‹æä¾›å•†ï¼Œå¦‚ Azureã€Cloudflare ç­‰ï¼›</li>
<li>ä½¿ç”¨ zodjs çº¦å®šæ¨¡å‹è¾“å…¥è¾“å‡ºçš„æ•°æ®æ¨¡å‹ï¼Œå®Œå–„çš„ç±»å‹æ¨å¯¼ï¼›</li>
<li>å®Œå–„çš„æµå¼ä¼ è¾“æ”¯æŒ</li>
</ul>
<p>é…ç½® Nextjs å®ç°å¤§æ¨¡å‹çš„è°ƒç”¨ã€Function Call åŠŸèƒ½ä»¥åŠæµå¼ä¼ è¾“ï¼Œåªéœ€è¦å‡ è¡Œä»£ç ï¼š</p>
<pre><code class="language-typescript">// nextjs api/chat/route.ts
export async function POST() {
    cosnt res = await streamText({
        model,
        prompt: 'æé†’æˆ‘æ˜å¤©ä¸Šåˆä¸Šç­',
        tools: {
            createTool
        }
    })

    return res.toDataStreamResponse();
}
</code></pre>
<p>æ›´å¤šè¯·å‚è€ƒè¿™ç¯‡æ–‡ç«  <a href="https://youking-lib.github.io/post/ai-sdk-guide/">æ¯” langchainjs æ›´å¥½ç”¨çš„ AI SDK</a></p>
<h2 id="è¿ç»´">è¿ç»´</h2>
<h3 id="caddy-è½»æ¾ä»£æ›¿-nginx">Caddy - è½»æ¾ä»£æ›¿ Nginx</h3>
<p>Caddy çš„ä¼˜åŠ¿ä½“ç°åœ¨ï¼š</p>
<ul>
<li>å®‰è£…ä½¿ç”¨éå¸¸ç®€å•ï¼Œé…ç½®æ–‡ä»¶ç®€æ´æ˜“è¯»</li>
<li>è‡ªåŠ¨ HTTPSï¼Œè¯ä¹¦è‡ªåŠ¨æ›´æ–°</li>
</ul>
<p>HTTPS è¯ä¹¦çš„è‡ªåŠ¨åŒ–æ˜¯æœ€çœå¿ƒçš„åŠŸèƒ½ï¼Œå®‰è£… Caddy ä¹‹åï¼Œä½ åªéœ€è¦ä½œå¦‚ä¸‹çš„é…ç½®ï¼Œå°±å¯ä»¥å®ç° HTTPS æ— å¿§äº†ï¼š</p>
<pre><code class="language-yml"># Caddyfile
app.domain.com {
        reverse_proxy :3000 {
                header_up Host {host} # redundant
        }
}
</code></pre>
<p>è¯¦ç»†ç”¨æ³•å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://youking-lib.github.io/post/caddy-guide/">ä½¿ç”¨ Caddy è½»æ¾ä»£æ›¿ Nginxï¼Œå®ç° HTTPS è‡ªåŠ¨ç»­æ¯ï¼</a></p>
<h3 id="ä½¿ç”¨-docker-compose-å¿«é€Ÿéƒ¨ç½²å¸¸ç”¨çš„æœåŠ¡">ä½¿ç”¨ Docker Compose å¿«é€Ÿéƒ¨ç½²å¸¸ç”¨çš„æœåŠ¡</h3>
<p>è™½ç„¶ Cloudflare å·²ç»æä¾›äº†å¤§éƒ¨åˆ†å…è´¹æœåŠ¡ï¼Œä½†ä»æœ‰ä¸€äº›ä¸šåŠ¡æ— æ³•æ”¯æŒï¼Œæ¯”å¦‚æƒ³è¦éƒ¨ç½²ä¸€ä¸ª mysql æœåŠ¡ã€ç‹¬ç«‹éƒ¨ç½²ä¸€å¥—å¼€æºçš„ SAAS æœåŠ¡</p>
<p>è¯¦ç»†è¯·å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://youking-lib.github.io/post/usefull-docker-compose-configs/">ä½¿ç”¨ Docker Compose å¿«é€Ÿéƒ¨ç½²å¸¸ç”¨çš„æœåŠ¡</a> å®‰è£…å¦‚ä¸‹ä½ å¯èƒ½ä¼šç”¨åˆ°çš„å®¹å™¨æœåŠ¡ï¼š</p>
<ul>
<li>[SAAS] Dify https://dify.ai/</li>
<li>[SAAS] Umami https://umami.is/</li>
<li>[SAAS] Flowise AI https://flowiseai.com/</li>
<li>[SAAS] Firecrawl çˆ¬è™«  https://www.firecrawl.dev/</li>
<li>[æ•°æ®åº“] Mysql</li>
<li>[æ•°æ®åº“] MongoDB</li>
<li>[æ•°æ®åº“] Milvus</li>
<li>[æ•°æ®åº“] Neo4j</li>
<li>[ä¸­é—´ä»¶] Kafka</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å²ä¸Šæœ€ç®€å•é«˜æ•ˆçš„çŠ¶æ€ç®¡ç†]]></title>
        <id>https://youking.vsh.cc/post/use-immer-state-manager/</id>
        <link href="https://youking.vsh.cc/post/use-immer-state-manager/">
        </link>
        <updated>2024-12-27T02:46:41.000Z</updated>
        <content type="html"><![CDATA[<h2 id="åœºæ™¯">åœºæ™¯</h2>
<ol>
<li>ç®€å•ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ç®¡ç†</li>
<li>å¤æ‚çš„ä¸šåŠ¡ç»„ä»¶çŠ¶æ€ç®¡ç†</li>
<li>æ•´ä¸ªåº”ç”¨çš„çŠ¶æ€ç®¡ç†</li>
</ol>
<h2 id="ä¼˜åŠ¿">ä¼˜åŠ¿</h2>
<p>ä½¿ç”¨ use-immer ç®¡ç†çŠ¶æ€çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>[æ¥è¿‘åŸç”Ÿ JS çš„å¼€å‘ä½“éªŒ] ä½¿ç”¨æ¥è¿‘ js åŸç”Ÿå¯¹è±¡çš„é£æ ¼æ“ä½œä¸å¯å˜æ•°æ®ï¼Œå¼•å…¥çš„æ¦‚å¿µå°‘ï¼›</li>
<li>[ä¸ React æ— ç¼ç»“åˆ] ä¸ react ç»“åˆï¼ŒçŠ¶æ€å˜æ›´å¯é¢„æµ‹ï¼Œè°ƒè¯•å‹å¥½ï¼Œdiff å˜æ›´æ—¶æ— å¿ƒæ™ºè´Ÿæ‹…ï¼›</li>
<li>[çµæ´»æ‹“å±•] æŒ‰éœ€æ‹“å±•åœºæ™¯ï¼Œå¦‚ Selectorã€Mutation ç­‰ï¼ŒçŠ¶æ€æµè½¬ç™½ç›’åŒ–ï¼›</li>
</ul>
<h3 id="1-æ¥è¿‘åŸç”Ÿ-js-çš„å¼€å‘ä½“éªŒ">1 æ¥è¿‘åŸç”Ÿ JS çš„å¼€å‘ä½“éªŒ</h3>
<ol>
<li>ç›¸å¯¹äº zustandã€redux ç­‰ï¼Œå¼•å…¥çš„æ¦‚å¿µå°‘ï¼ŒAPI è®¾è®¡ç®€å•</li>
</ol>
<pre><code class="language-typescript">function List() {
    const [state, dispatch] = useImmer({
        loading: true,
        posts: []
    })

    useEffect(() =&gt; {
        getAllPosts().then(posts =&gt; {
            dispatch(draft =&gt; {
                draft.loading = false;
                draft.posts = posts;
            })
        })
    }, [])
}
</code></pre>
<ol start="2">
<li>ts çš„ class å¯ä»¥ä½œä¸ºç±»å‹ä½¿ç”¨ï¼Œimmer ç»“åˆ class å®šä¹‰çŠ¶æ€ï¼Œç»“æ„æ¸…æ™°ã€ç±»å‹å‹å¥½ï¼š</li>
</ol>
<pre><code class="language-typescript">export class State {
  [immerable] = true;

  loading = true;
  posts: Post[] = [];
}

function List() {
    const [state, dispatch] = useImmer(() =&gt; new State());
}
</code></pre>
<h3 id="2-ä¸-react-æ— ç¼ç»“åˆ">2 ä¸ React æ— ç¼ç»“åˆ</h3>
<ol>
<li>ä¸Šè¿°çš„ä»£ç ç‰‡æ®µå·²ç»å±•ç¤ºäº†ä½¿ç”¨ user-immer ç®¡ç†ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ï¼Œç®€å•æ–¹ä¾¿ï¼›</li>
<li>é€šè¿‡ React Context åœ¨ç»„ä»¶æ ‘ä¸­ä¼ é€’ç»„ä»¶çŠ¶æ€</li>
</ol>
<pre><code class="language-typescript">// 1. åˆ›å»º Context Ref
const ModelContext = createContext&lt;{ state: State, dispatch }&gt;();

// 2. æä¾› State
function Root() {
    const [state, dispatch] = useImmer(() =&gt; new State());

    return (
        &lt;ModelContext.Provider value={{ state, dispatch }}&gt;
            {children}
        &lt;/StateRefContext.Provider&gt;
    )
}

// 3. å®šä¹‰ hooks
export const useModel = () =&gt; useContext(ModelContext);

// 4. å­ç»„ä»¶è®¿é—®
function List() {
    const model = useModel();

    // model.state.loading
}
</code></pre>
<ol start="3">
<li>åŸºäº immer çš„ä¸å¯å˜æ•°æ®ï¼Œdiff æ— å¿ƒæ™ºè´Ÿæ‹…</li>
</ol>
<pre><code class="language-typescript">function List() {
    const model = useModel();

    useEffect(() =&gt; {
        // posts å‘ç”Ÿå˜åŒ–
    }, [model.state.posts])
}
</code></pre>
<h3 id="3-çµæ´»æ‹“å±•ä½¿ç”¨åœºæ™¯">3 çµæ´»æ‹“å±•ä½¿ç”¨åœºæ™¯</h3>
<ol>
<li>çº¯å‡½æ•°é£æ ¼çš„ Selectorï¼ŒMutation</li>
</ol>
<pre><code class="language-typescript">import { immerable, produce } from 'immer';

// 1. å®šä¹‰çŠ¶æ€
export class State {
  [immerable] = true;

  loading = true;
  posts: Post[] = [];

  static set(state: State, recipe: (draft: State) =&gt; void) {
    return produce(state, recipe);
  }
}

// 2. å®šä¹‰ Selectorã€Mutation
const getPosts = (state: State) =&gt; model.posts
const setPosts = (draft: State, posts: State['posts']) =&gt; {
    draft.posts = posts
}
</code></pre>
<ol start="2">
<li>ç¼“å­˜ Selector ç»“æœï¼Œé¿å…ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œæå‡æ€§èƒ½</li>
</ol>
<pre><code class="language-typescript">// 3. å®šä¹‰ useSelector ç¼“å­˜ç»“æœï¼Œé¿å…ä¸
function useSelector&lt;T&gt;(
  selector: (state: State) =&gt; T,
  deps: DependencyList = []
): T {
  const model = useModel();
  const state = useModelState();

  return useMemo(() =&gt; selector(state), [state, selector, ...deps]);
}

function Lists() {
    const posts = useSelector(getPosts);
}
</code></pre>
<ol start="3">
<li>å­ç»„ä»¶é©±åŠ¨æ•°æ®æ›´æ–°ï¼Œæ»¡è¶³å¤æ‚çš„ä¸šåŠ¡åœºæ™¯</li>
</ol>
<pre><code class="language-typescript">function useDispatch() {
    const model = useModel();
    return useMemo(() =&gt; model.dispatch, [model.dispatch]);
}

function Lists() {
    const posts = useSelector(getPosts);
    const dispatch = useDispatch();

    useEffect(() =&gt; {
        getAllPosts().then(posts =&gt; {
            dispatch(draft =&gt; setPosts(draft, posts))
        })
    }, [])
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ„å»ºç±»å‹å®‰å…¨çš„ API æ¥å£ - OpenAPI è‡ªåŠ¨æˆ TS æ¥å£æ–‡ä»¶]]></title>
        <id>https://youking.vsh.cc/post/honojs-zod-openapi/</id>
        <link href="https://youking.vsh.cc/post/honojs-zod-openapi/">
        </link>
        <updated>2024-12-26T14:08:37.000Z</updated>
        <content type="html"><![CDATA[<h2 id="æ–¹æ¡ˆ">æ–¹æ¡ˆ</h2>
<ul>
<li><a href="https://hono.dev/docs/getting-started/basic">Honojs</a> è½»é‡æœåŠ¡æ¡†æ¶ï¼Œæ”¯æŒè¿è¡Œåœ¨å„ç§å¹³å°ï¼Œå¦‚ Cloudflare Workerã€Vercelï¼Œæ”¯æŒç»§æ‰¿åˆ° Nextjsï¼›</li>
<li><a href="https://hono.dev/examples/zod-openapi">@hono/zod-openapi</a> åŸºäº Zodjs å®šä¹‰ Swagger æ¥å£</li>
<li><a href="https://hono.dev/examples/swagger-ui">@hono/swagger-ui</a> ç”Ÿæˆ Swagger æ¥å£æ–‡æ¡£</li>
<li>ä½¿ç”¨ <a href="https://github.com/acacode/swagger-typescript-api">swagger-typescript-api</a> ç”Ÿæˆ ts æ¥å£æ–‡ä»¶</li>
</ul>
<h2 id="ä¼˜åŠ¿">ä¼˜åŠ¿</h2>
<ul>
<li>è¾“å‡ºè§„èŒƒçš„ Swagger æ¥å£æ–‡æ¡£ï¼Œæ”¯æŒä»£ç ç”Ÿæˆï¼›</li>
<li>åŸºäº zodjs ç”Ÿæˆçš„ schemaï¼Œè‡ªåŠ¨çš„æ•°æ®æ ¡éªŒä¸ç±»å‹æ¨å¯¼ï¼›</li>
<li>åŸºäºè½»é‡çº§çš„ Honojs æ¡†æ¶ï¼Œç›¸åŒçš„ä»£ç æ”¯æŒåœ¨æ‰€æœ‰å¹³å°è¿è¡Œï¼›</li>
</ul>
<h4 id="å®ç°">å®ç°</h4>
<ol>
<li>ä½¿ç”¨ zod-openapi å®šä¹‰ä¸€ä¸ª OpenAPI è·¯ç”±</li>
</ol>
<pre><code class="language-typescript">// route.schema.ts
export const ShopProfile = z.object({
  id: z.string(),
  shop: z.string(),
  title: z.string()
}).openapi('ShopProfileVo', {
  description: 'å•†åº—è¯¦æƒ…'
});

export const GetShopProfileRoute = createRoute({
  tags: ['Shop'],
  method: 'get',
  path: '/shop/{shopId}',
  request: {
    params: z.object({
      shopId: z.string()
    })
  },
  responses: {
    200: {
      content: {
        'application/json': {
          schema: ShopProfile
        }
      },
      description: 'GetShopProfileRoute'
    }
  }
});
</code></pre>
<ol start="2">
<li>æ ¹æ®è·¯ç”± Schema å®ç°è·¯ç”±</li>
</ol>
<pre><code class="language-typescript">import { OpenAPIHono } from '@hono/zod-openapi'
import { GetShopProfileRoute } from './route.schema.ts'

const api = new OpenAPIHono();

api.openapi(GetShopProfileRoute, async c =&gt; {
    const { shopId } = c.valid('params');

    const shopProfile = await prisma.ShopProfile.findUnique({
        where: {
            id: shopId
        }
    })

    return c.json(shopProfile, 200)
})
</code></pre>
<ol start="3">
<li>ç”Ÿæˆ Swagger æ–‡ä»¶</li>
</ol>
<pre><code class="language-typescript">api.doc('/swagger/doc', (c) =&gt; {
    return {
        openapi: '3.1.0',
        servers: [
            {
                url: new URL(c.req.url).origin,
                description: 'Current environment',
            },
        ],
        info: {
            version: '0.0.1',
            title: 'asp-api',
            description: 'asp-api swagger',
        },
    }
})
</code></pre>
<ol start="4">
<li>[å¯é€‰] ä½¿ç”¨ swagger-ui æ¸²æŸ“æ¥å£æ–‡æ¡£</li>
</ol>
<pre><code class="language-typescript">
api.get('/swagger/ui', swaggerUI({
    url: '/api/swagger/doc',
    persistAuthorization: true
}))
</code></pre>
<ol start="5">
<li>ä½¿ç”¨ <a href="https://github.com/acacode/swagger-typescript-api">swagger-typescript-api</a> ç”Ÿæˆ ts æ¥å£æ–‡ä»¶</li>
</ol>
<pre><code class="language-typescript">// generate.ts
// tsx ./generate.ts
import { generateApi } from 'swagger-typescript-api'

gen();

async function gen() {
    await generateApi({
        name: 'index.ts',
        output: path.resolve(__dirname, 'gen', './api'),
        url: 'http://127.0.0.1:3010/api/swagger/doc',
    })
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ORM ä¸ºä»€ä¹ˆé€‰æ‹© Prismajs]]></title>
        <id>https://youking.vsh.cc/post/prisma-guide/</id>
        <link href="https://youking.vsh.cc/post/prisma-guide/">
        </link>
        <updated>2024-12-26T13:53:24.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä¼˜åŠ¿">ä¼˜åŠ¿</h2>
<ol>
<li>åŸºäºé¢å‘å¯¹è±¡çš„æŸ¥è¯¢æ¥å£ï¼Œçµæ´»ä¸”æµç•…ï¼ŒTS ç±»å‹æ¨å¯¼éå¸¸ä¸¥è°¨å®‰å…¨ï¼›</li>
<li>æ”¯æŒå¤šç§æ•°æ®åº“ï¼Œå¦‚ MySQLã€PostgreSQLã€CloudFlare D1ã€MongoDB ç­‰ï¼Œå®Œç¾é€‚åº”ä¸åŒå›¢é˜Ÿã€é¡¹ç›®çš„é€‰å‹åå¥½ï¼Œå³ä½¿ä½ æ²¡æœ‰ SQL è¯­æ³•çš„ä½¿ç”¨ç»éªŒï¼›</li>
<li>æ¸…æ™°çš„æ•°æ®æ¨¡å‹å®šä¹‰ DSLã€å®Œæ•´çš„è¿ç§»åŒæ­¥å·¥å…·ã€ä¸°å¯Œçš„æ–‡æ¡£ä¸å¼ºå¤§çš„ç¤¾åŒºï¼›</li>
<li>æ”¯æŒ Cloudflare D1ï¼</li>
</ol>
<h4 id="ä¸-dirzzle-çš„å¯¹æ¯”">ä¸ dirzzle çš„å¯¹æ¯”</h4>
<table>
<thead>
<tr>
<th>æ¯”è¾ƒé¡¹ç›®</th>
<th>Prisma</th>
<th>Drizzle</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å®šä¹‰æ–¹å¼</strong></td>
<td>- ä½¿ç”¨ Prisma Schemaï¼ˆ<code>.prisma</code>æ–‡ä»¶ï¼‰æ¥å®šä¹‰æ•°æ®æ¨¡å‹ï¼Œé€šè¿‡ç±»ä¼¼äº DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰çš„è¯­æ³•å®šä¹‰è¡¨ã€åˆ—ã€å…³ç³»ç­‰ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç›´è§‚åœ°å®šä¹‰<code>model User { id Int @id; name String; }</code>æ¥è¡¨ç¤º<code>User</code>è¡¨ã€‚ - è¿™ç§æ–¹å¼å°†æ•°æ®åº“ç»“æ„å’Œä¸šåŠ¡é€»è¾‘ä¸­çš„æ•°æ®æ¨¡å‹è¿›è¡Œäº†æ¸…æ™°çš„åˆ†ç¦»ã€‚</td>
<td>- åœ¨ä»£ç ä¸­ç›´æ¥ä½¿ç”¨ JavaScript æˆ– TypeScript æ¥å®šä¹‰æ•°æ®åº“æ¶æ„ï¼Œé€šå¸¸æ˜¯é€šè¿‡å‡½æ•°è°ƒç”¨å’Œå¯¹è±¡å­—é¢é‡çš„æ–¹å¼ã€‚ - ä¾‹å¦‚ï¼Œåœ¨ Drizzle ä¸­å¯èƒ½ä¼šå®šä¹‰ä¸€ä¸ªè¡¨ç»“æ„ç±»ä¼¼<code>const usersTable = drizzle.schema.createTable(&quot;users&quot;, { columns: { id: int(&quot;id&quot;).primaryKey(), name: varchar(&quot;name&quot;) } });</code>ã€‚</td>
</tr>
<tr>
<td><strong>æ•°æ®åº“è¿ç§»</strong></td>
<td>- Prisma æä¾›äº†ä¸€å¥—å®Œæ•´çš„è¿ç§»å·¥å…·ï¼Œé€šè¿‡<code>prisma migrate</code>å‘½ä»¤ã€‚å®ƒå¯ä»¥è‡ªåŠ¨ç”Ÿæˆè¿ç§»æ–‡ä»¶ï¼Œå¹¶å°†æ•°æ®åº“ç»“æ„çš„å˜æ›´åº”ç”¨åˆ°æ•°æ®åº“ä¸­ã€‚ - èƒ½å¤Ÿå¾ˆå¥½åœ°è·Ÿè¸ªæ•°æ®åº“æ¶æ„çš„å˜åŒ–å†å²ï¼Œæ–¹ä¾¿å›¢é˜Ÿåä½œå’Œåœ¨ä¸åŒç¯å¢ƒä¸­åŒæ­¥æ•°æ®åº“ç»“æ„ã€‚</td>
<td>- Drizzle çš„è¿ç§»ç›¸å¯¹æ¥è¯´æ›´åŠ çµæ´»ï¼Œå®ƒå¯ä»¥é€šè¿‡ç¼–å†™è‡ªå®šä¹‰çš„ SQL è„šæœ¬æˆ–è€…åˆ©ç”¨ä¸€äº›ç¤¾åŒºæä¾›çš„è½»é‡çº§è¿ç§»å·¥å…·æ¥å®ç°æ•°æ®åº“è¿ç§»ã€‚ - è¿™ç§æ–¹å¼å¯¹äºç†Ÿæ‚‰ SQL çš„å¼€å‘è€…æ¥è¯´å¯èƒ½æ›´åŠ ç›´è§‚ï¼Œä½†å¯èƒ½éœ€è¦å¼€å‘è€…è‡ªå·±å¤„ç†æ›´å¤šçš„ç»†èŠ‚ï¼Œæ¯”å¦‚ç‰ˆæœ¬æ§åˆ¶å’Œå†²çªè§£å†³ã€‚</td>
</tr>
<tr>
<td><strong>æŸ¥è¯¢æ„å»º</strong></td>
<td>- Prisma æä¾›äº†ä¸€ç§æµç•…çš„ã€é¢å‘å¯¹è±¡çš„æŸ¥è¯¢æ„å»ºæ–¹å¼ã€‚ä¾‹å¦‚ï¼Œè¦æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨å¯ä»¥è¿™æ ·å†™ï¼š<code>const users = await prisma.user.findMany();</code>ï¼Œè¿™ç§æ–¹å¼å¾ˆç¬¦åˆ JavaScript/TypeScript å¼€å‘è€…çš„ä¹ æƒ¯ã€‚ - æ”¯æŒå¤æ‚çš„å…³è”æŸ¥è¯¢ï¼Œå¹¶ä¸”èƒ½å¤Ÿè‡ªåŠ¨å¤„ç†å…³ç³»æ•°æ®çš„åŠ è½½å’Œè§£æï¼Œé€šè¿‡<code>include</code>å’Œ<code>select</code>å…³é”®å­—ç­‰å¯ä»¥çµæ´»æ§åˆ¶æŸ¥è¯¢çš„æ•°æ®èŒƒå›´ã€‚</td>
<td>- Drizzle çš„æŸ¥è¯¢æ„å»ºæ›´æ¥è¿‘ SQL çš„æ€ç»´æ–¹å¼ï¼Œåœ¨ä»£ç ä¸­ä¼šçœ‹åˆ°æ›´å¤š SQL è¯­æ³•çš„å½±å­ã€‚ä¾‹å¦‚ï¼Œ<code>const query = select().from(usersTable).where(eq(usersTable.id, 1));</code>ã€‚ - å¯¹äºç®€å•æŸ¥è¯¢æ¥è¯´ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥æ¯”è¾ƒç®€æ´æ˜äº†ï¼Œä½†å¯¹äºå¤æ‚çš„å…³è”æŸ¥è¯¢å’ŒåµŒå¥—æŸ¥è¯¢ï¼Œå¯èƒ½éœ€è¦ç¼–å†™æ›´å¤šçš„ä»£ç æ¥å®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚</td>
</tr>
<tr>
<td><strong>ç±»å‹å®‰å…¨</strong></td>
<td>- Prisma åœ¨ç±»å‹å®‰å…¨æ–¹é¢è¡¨ç°å‡ºè‰²ï¼Œå®ƒä¼šæ ¹æ®å®šä¹‰çš„<code>.prisma</code>æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆç±»å‹å®šä¹‰æ–‡ä»¶ï¼ˆ<code>.d.ts</code>ï¼‰ï¼Œåœ¨ä»£ç ç¼–è¾‘å™¨ä¸­èƒ½å¤Ÿæä¾›å¾ˆå¥½çš„ç±»å‹æç¤ºã€‚ - è¿™ä½¿å¾—åœ¨ç¼–å†™æŸ¥è¯¢å’Œå¤„ç†æ•°æ®æ—¶ï¼Œèƒ½å¤ŸåŠæ—¶å‘ç°ç±»å‹ä¸åŒ¹é…ç­‰é”™è¯¯ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯çš„å‘ç”Ÿã€‚</td>
<td>- Drizzle ä¹Ÿæ³¨é‡ç±»å‹å®‰å…¨ï¼Œå®ƒé€šè¿‡ä½¿ç”¨ TypeScript çš„ç±»å‹ç³»ç»Ÿï¼Œç»“åˆè‡ªèº«çš„ç±»å‹å®šä¹‰ï¼Œä¸ºæ•°æ®åº“æ“ä½œæä¾›ç±»å‹æ”¯æŒã€‚ - ä¸è¿‡ï¼Œç”±äºå…¶æŸ¥è¯¢æ„å»ºæ–¹å¼æ¯”è¾ƒçµæ´»ï¼Œå¯èƒ½éœ€è¦å¼€å‘è€…æ›´åŠ ä»”ç»†åœ°å®šä¹‰å’Œç»´æŠ¤ç±»å‹ï¼Œä»¥ç¡®ä¿ç±»å‹å®‰å…¨ã€‚</td>
</tr>
<tr>
<td><strong>æ€§èƒ½</strong></td>
<td>- Prisma åœ¨æ€§èƒ½æ–¹é¢åšäº†å¾ˆå¤šä¼˜åŒ–ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®å’Œå¤æ‚æŸ¥è¯¢æ—¶ï¼Œå®ƒèƒ½å¤Ÿæœ‰æ•ˆåœ°åˆ©ç”¨æ•°æ®åº“è¿æ¥æ± ï¼Œå‡å°‘ä¸å¿…è¦çš„æ•°æ®åº“è¯·æ±‚ã€‚ - ä¸è¿‡ï¼Œåœ¨ä¸€äº›ç‰¹å®šåœºæ™¯ä¸‹ï¼Œå¦‚é«˜åº¦å®šåˆ¶åŒ–çš„ SQL æŸ¥è¯¢æˆ–è€…å¯¹æ€§èƒ½è¦æ±‚æé«˜çš„åœºæ™¯ï¼Œå¯èƒ½ä¼šå—åˆ°å…¶æŠ½è±¡å±‚çš„é™åˆ¶ã€‚</td>
<td>- Drizzle ç”±äºå…¶æ›´æ¥è¿‘åº•å±‚ SQL çš„æ“ä½œæ–¹å¼ï¼Œåœ¨æ€§èƒ½ä¼˜åŒ–æ–¹é¢å¯èƒ½å…·æœ‰ä¸€å®šçš„çµæ´»æ€§ã€‚å¼€å‘è€…å¯ä»¥æ ¹æ®å…·ä½“çš„æ€§èƒ½éœ€æ±‚ç¼–å†™æ›´é«˜æ•ˆçš„ SQL æŸ¥è¯¢ã€‚ - ä½†æ˜¯ï¼Œè¿™ä¹Ÿæ„å‘³ç€å¼€å‘è€…éœ€è¦å¯¹æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–æœ‰æ›´æ·±å…¥çš„äº†è§£ï¼Œå¹¶ä¸”åœ¨ä»£ç ç»´æŠ¤è¿‡ç¨‹ä¸­éœ€è¦æ›´åŠ æ³¨æ„æ€§èƒ½é—®é¢˜ã€‚</td>
</tr>
<tr>
<td><strong>ç”Ÿæ€ç³»ç»Ÿå’Œç¤¾åŒºæ”¯æŒ</strong></td>
<td>- Prisma æ‹¥æœ‰è¾ƒå¤§çš„ç¤¾åŒºå’Œä¸°å¯Œçš„æ–‡æ¡£èµ„æºï¼Œè®¸å¤šæµè¡Œçš„æ¡†æ¶å’Œå·¥å…·éƒ½æœ‰ä¸ä¹‹é›†æˆçš„æ¡ˆä¾‹å’Œæ’ä»¶ã€‚ - è¿™ä½¿å¾—åœ¨é‡åˆ°é—®é¢˜æ—¶ï¼Œæ›´å®¹æ˜“æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”å¯ä»¥æ–¹ä¾¿åœ°ä¸å…¶ä»–æŠ€æœ¯æ ˆè¿›è¡Œæ•´åˆã€‚</td>
<td>- Drizzle ç›¸å¯¹æ¥è¯´æ˜¯ä¸€ä¸ªè¾ƒæ–°çš„å·¥å…·ï¼Œç¤¾åŒºè§„æ¨¡è¾ƒå°ï¼Œä½†æ­£åœ¨é€æ¸å‘å±•å£®å¤§ã€‚ - æ–‡æ¡£èµ„æºä¹Ÿåœ¨ä¸æ–­å®Œå–„ï¼Œåœ¨ä¸€äº›æ–°å…´çš„æŠ€æœ¯æ ˆæˆ–è€…å¯¹çµæ´»æ€§è¦æ±‚è¾ƒé«˜çš„é¡¹ç›®ä¸­å¼€å§‹å¾—åˆ°åº”ç”¨ã€‚</td>
</tr>
</tbody>
</table>
<h2 id="prisma-usefull-tips">Prisma usefull tips</h2>
<p>ä»¥ä¸‹æ˜¯ Prisma çš„ä½¿ç”¨åœºæ™¯ï¼Œæ„Ÿå—ä»¥ä¸‹ Prisma çš„ä¾¿æ·æ€§ï¼š</p>
<ol>
<li>å…³è”æ•°æ®åˆ›å»ºåœºæ™¯ï¼šåˆå§‹åŒ–é¡¹ç›®ä»¥åŠé¡¹ç›®çš„ç®¡ç†å‘˜</li>
</ol>
<pre><code class="language-typescript">const project = await prisma.project.create({
    data: {
        title: 'default project',
        owner: {
            create: {
                username: 'ç®¡ç†å‘˜'
            }
        }
    }
})
</code></pre>
<ol start="2">
<li>å…³è”æŸ¥è¯¢åœºæ™¯ï¼šæŸ¥è¯¢é¡¹ç›®è¯¦æƒ…å¹¶å…³è”å‡ºç®¡ç†å‘˜ä¿¡æ¯</li>
</ol>
<pre><code class="language-typescript">// å…³è”æŸ¥è¯¢
function getProject(id: string) {
    return prisma.project.findUnique({
        where: {
            id
        },
        include: {
            owner: true,
        }
    })
}
</code></pre>
<h2 id="cloudflare-d1-æ”¯æŒ">Cloudflare D1 æ”¯æŒ</h2>
<ul>
<li>Cloudlfare D1 æä¾›è¶³å¤Ÿçš„å…è´¹é¢åº¦ï¼Œå¼€å‘è€…ä¹Ÿä¸éœ€è¦ä¸ºæ•°æ®åº“çš„è¿ç»´è´¹å¿ƒæ€</li>
<li>åŸºäº sqlite çš„ D1 æ•°æ®ç±»å‹æ”¯æŒçš„ä¸å¤šï¼Œæ¯”å¦‚æ— æ³•æ”¯æŒæšä¸¾ç±»å‹</li>
</ul>
<p>å‚è€ƒ <a href="https://www.prisma.io/docs/orm/overview/databases/cloudflare-d1">Prsimajs å®˜æ–¹æ–‡æ¡£</a></p>
<h2 id="ä½¿ç”¨-zod-prisma-è‡ªåŠ¨ç”Ÿæˆæ ¡éªŒæ–‡ä»¶">ä½¿ç”¨ zod-prisma è‡ªåŠ¨ç”Ÿæˆæ ¡éªŒæ–‡ä»¶</h2>
<ol>
<li>å®‰è£… <code>zod-prisma</code>ï¼›</li>
<li>é…ç½® schema.prisma æ–‡ä»¶ï¼›</li>
</ol>
<pre><code class="language-prisma">generator zod {
  provider = &quot;zod-prisma&quot;
  output   = &quot;./zods&quot;
}
</code></pre>
<ol start="3">
<li>è¿è¡Œ prisma generate æ—¶ï¼Œä¼šè‡ªåŠ¨æ ¹æ®æ•°æ®åº“çš„å®šä¹‰ç”Ÿæˆ zod æ–‡ä»¶ï¼›</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç»“åˆ react-email é›¶æˆæœ¬å®šåˆ¶é‚®ä»¶ç³»ç»Ÿ]]></title>
        <id>https://youking.vsh.cc/post/send-email/</id>
        <link href="https://youking.vsh.cc/post/send-email/">
        </link>
        <updated>2024-12-26T13:27:53.000Z</updated>
        <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ‰ä¸¤ç§å¸¸ç”¨çš„æ–¹å¼ï¼š</p>
<ol>
<li>åŸŸåè§£æåˆ°é‚®ä»¶ Saas æœåŠ¡ï¼Œå¦‚ <a href="https://resend.com/">Resend</a>ã€<a href="https://www.useplunk.com/">Plunk</a> ç­‰ï¼Œæ¨è Plunkï¼Œå¼€æºä¸”æ”¯æŒç‹¬ç«‹éƒ¨ç½²ï¼›</li>
<li>SMTP + nodemailer</li>
</ol>
<p>æ–¹å¼1 æ¯”è¾ƒç®€å•ï¼Œä½†ä¾èµ–è‡ªå·±çš„åŸŸå TXT ç­‰è®°å½•è§£æï¼Œå¯ä»¥ç›´æ¥å‚è€ƒå®˜æ–¹æ–‡æ¡£è¿›è¡Œé…ç½®ã€‚</p>
<p>ç”±äºç¬”è€…å·²ç»å°†é‚®ä»¶æ‰˜ç®¡åˆ°äº†é£ä¹¦ï¼Œå› æ­¤é€‰æ‹©ç¬¬äºŒç§æ–¹å¼ã€‚</p>
<h2 id="ä½¿ç”¨-nodemailer-å‘é€é‚®ä»¶">ä½¿ç”¨ nodemailer å‘é€é‚®ä»¶</h2>
<ol>
<li>é‚®ä»¶ç®¡ç†ç•Œé¢è·å–é‚®ä»¶çš„ SMTP</li>
</ol>
<pre><code># .env
EMAIL_HOST=smtp.feishu.cn
EMAIL_PORT=465
EMAIL_USER=support@domain.com
EMAIL_PASS=your smtp pass
EMAILDEFAULT_FROM=support@domain.com
</code></pre>
<pre><code class="language-typescript">export const emailConstants = {
  HOST: process.env.EMAIL_HOST!,
  PORT: Number(process.env.EMAIL_PORT!),
  USER: process.env.EMAIL_USER!,
  PASS: process.env.EMAIL_PASS!,
  EMAILDEFAULT_FROM: process.env.EMAILDEFAULT_FROM!
};
</code></pre>
<ol start="2">
<li>ä½¿ç”¨ nodemailer å‘é€é‚®ä»¶</li>
</ol>
<pre><code class="language-typescript">import nodemailer from 'nodemailer';
import { emailConstants } from './constants';

export type CreateEmailSenderOptions = {
  host: string;
  port: number;
  secure: boolean;
  auth: {
    user: string;
    pass: string;
  };
};
export type SendMailOptions = {
  from?: string;
  to: string;
  body: string;
  subject: string;
};
const transporter = nodemailer.createTransport({
  host: emailConstants.HOST,
  port: emailConstants.PORT,
  secure: true,
  auth: {
    user: emailConstants.USER,
    pass: emailConstants.PASS
  }
});

export async function sendEmail({ from, to, body, subject }: SendMailOptions) {
  return transporter.sendMail({
    to,
    subject,
    from: from || emailConstants.EMAILDEFAULT_FROM,
    html: body
  });
}
</code></pre>
<h2 id="ä½¿ç”¨-react-email-å®šåˆ¶é‚®ä»¶æ¨¡ç‰ˆ">ä½¿ç”¨ react-email å®šåˆ¶é‚®ä»¶æ¨¡ç‰ˆ</h2>
<blockquote>
<p>å—é™äº Cloudflare Worker çš„è¿è¡Œæ—¶ï¼Œnodemailer è¿˜ä¸æ”¯æŒè¿è¡Œåœ¨ Cloudlfare Worker ä¸Šï¼Œ<a href="https://github.com/nodemailer/nodemailer/issues/1623#issuecomment-1976024001">å‚è€ƒ Issue</a></p>
</blockquote>
<ol>
<li>æ¨èå…ˆä½¿ç”¨ nextjs åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®</li>
<li><a href="https://react.email/docs/getting-started/manual-setup">æ‰‹åŠ¨å®‰è£… react-emial</a></li>
</ol>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;email-app&quot;,
  &quot;scripts&quot;: {
    &quot;dev:email&quot;: &quot;email dev&quot;,
  },
  &quot;devDependencies&quot;: {
    &quot;react-email&quot;: &quot;^3.0.1&quot;,
  }
}
</code></pre>
<ol start="3">
<li>
<p>ç¼–å†™é‚®ä»¶æ¨¡ç‰ˆ</p>
</li>
<li>
<p>æµ‹è¯•å‘é€æ¨¡ç‰ˆ</p>
</li>
</ol>
<pre><code class="language-typescript">import { render } from '@react-email/components';
import { sendEmail } from '@/libs/email';

const html = await render(&lt;WelcomeEmail /&gt;)

sendEmail({
    to: 'youremail@gmail.com',
    subject: 'Welcome!',
    body: html
});
</code></pre>
<h2 id="ä½¿ç”¨-openapi-æ„å»ºç‹¬ç«‹çš„é‚®ä»¶æœåŠ¡">ä½¿ç”¨ OpenAPI æ„å»ºç‹¬ç«‹çš„é‚®ä»¶æœåŠ¡</h2>
<ol>
<li>å®šä¹‰å‘é€é‚®ä»¶è·¯ç”±</li>
</ol>
<pre><code class="language-typescript">export const SendEmailRoute = createRoute({
  tags: ['Email'],
  method: 'post',
  path: '/send-email',
  request: {
    body: {
      content: {
        'application/json': {
          schema: z.object({
            from: z.string().optional(),
            to: z.string(),
            subject: z.string(),
            body: z.string()
          })
        }
      }
    }
  },
  responses: {
    200: {
      content: {
        'application/json': {
          schema: z.object({
            success: z.boolean()
          })
        }
      },
      description: 'SendEmailRoute'
    }
  }
});
</code></pre>
<ol start="2">
<li>è·¯ç”±å®ç°</li>
</ol>
<pre><code class="language-typescript">export function email(api: OpenAPIHono) {
  api.openapi(SendEmailRoute, async c =&gt; {
    const body = c.req.valid('json');

    await sendEmail({
      from: body.from,
      to: body.to,
      subject: body.subject,
      body: body.body
    });

    return c.json(
      {
        success: true
      },
      200
    );
  });
}
</code></pre>
<p>å‚è€ƒï¼š</p>
<blockquote>
<p><a href="https://demo.react.email/preview/notifications/vercel-invite-user">react-email template</a><br>
<a href="https://github.com/dubinc/dub/tree/main/apps/web/emails">dub.com é¡¹ç›®çš„é‚®ä»¶æ¨¡ç‰ˆ</a></p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ¯” langchainjs æ›´å¥½ç”¨çš„ AI SDK]]></title>
        <id>https://youking.vsh.cc/post/ai-sdk-guide/</id>
        <link href="https://youking.vsh.cc/post/ai-sdk-guide/">
        </link>
        <updated>2024-12-26T13:18:46.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä¼˜åŠ¿">ä¼˜åŠ¿</h2>
<ul>
<li>æ”¯æŒä¸åŒçš„æ¨¡å‹æä¾›å•†ï¼Œå¦‚ Azureã€Cloudflare ç­‰ï¼›</li>
<li>ä½¿ç”¨ zodjs çº¦å®šæ¨¡å‹è¾“å…¥è¾“å‡ºçš„æ•°æ®æ¨¡å‹ï¼Œå®Œå–„çš„ç±»å‹æ¨å¯¼ï¼›</li>
<li>å®Œå–„çš„æµå¼ä¼ è¾“æ”¯æŒ</li>
</ul>
<ol>
<li>æ”¯æŒä¸åŒçš„æ¨¡å‹æä¾›å•†</li>
</ol>
<pre><code class="language-typescript">import { createAzure } from '@ai-sdk/azure'
import { createOpenAI } from '@ai-sdk/openai'

import { LanguageModelV1, EmbeddingModel } from 'ai'

const azure = createAzure({
  apiKey: '[KEY]',
  baseURL: 'https:/[DEPLOYMENT].openai.azure.com/openai/deployments',
})

export const openai = createOpenAI({
  apiKey: 'xxx',
})
</code></pre>
<ol start="2">
<li>æµå¼ä¼ è¾“æ”¯æŒ</li>
</ol>
<pre><code class="language-typescript">// nextjs api/chat/route.ts
export async function POST() {
    cosnt res = await streamText({
        model,
        prompt: 'æé†’æˆ‘æ˜å¤©ä¸Šåˆä¸Šç­',
        tools: {
            createTool
        }
    })

    return res.toDataStreamResponse();
}
</code></pre>
<pre><code class="language-typescript">// hono
app.post('/api/chat', async c =&gt; {
    cosnt res = await streamText({
        model,
        prompt: 'æé†’æˆ‘æ˜å¤©ä¸Šåˆä¸Šç­',
        tools: {
            createTool
        }
    })

    return res.toDataStreamResponse();
})
</code></pre>
<ol start="3">
<li>æ”¯æŒç”Ÿæˆç»“æ„åŒ–æ•°æ®</li>
</ol>
<pre><code class="language-typescript">const { object } = await generateObject({
  model: azure('gpt-4o'),
  schema: z.object({
    username: z.string(),
  }),
  prompt: 'æå–ç”¨æˆ·åç§°.',
});

console.log(object.username)
</code></pre>
<ol start="4">
<li>åŸºäº zodjsï¼Œä¸¥æ ¼çº¦å®šå¤§æ¨¡å‹ Function Call çš„è¿”å›ç»“æœ</li>
</ol>
<pre><code class="language-typescript">const createTodo = tool({
    description: 'æ·»åŠ å¾…åŠæé†’',
    parameters: z.object({
      title: z.string().describe('å¾…åŠçš„å†…å®¹ï¼Œå°½é‡ä¿å­˜ç”¨æˆ·çš„åŸå§‹è¾“å…¥ï¼Œä¸è¦åšä»»ä½•å¤„ç†'),
      expiredAt: z.string().optional().describe('å¾…åŠåˆ°æœŸæ—¶é—´ï¼Œå¦‚æœï¼Œæ ¼å¼ä¸º YYYY-MM-DD HH:mm:ss'),
    }),
    async execute(params) {
        console.log(params.title, params.expiredAt)
    }
})
</code></pre>
<p>ç›¸å…³ï¼š</p>
<ul>
<li>[AI] RAG æŠ€æœ¯æ–¹æ¡ˆ</li>
<li>[AI] æå‡ AI è®°å¿†çš„å¸¸ç”¨æ–¹æ¡ˆ</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä½¿ç”¨ Caddy è½»æ¾ä»£æ›¿ Nginxï¼Œå®ç° HTTPS è‡ªåŠ¨ç»­æ¯ï¼]]></title>
        <id>https://youking.vsh.cc/post/caddy-guide/</id>
        <link href="https://youking.vsh.cc/post/caddy-guide/">
        </link>
        <updated>2024-12-26T13:09:57.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä¼˜åŠ¿">ä¼˜åŠ¿</h2>
<ul>
<li>å®‰è£…ä½¿ç”¨éå¸¸ç®€å•ï¼Œé…ç½®æ–‡ä»¶ç®€æ´æ˜“è¯»</li>
<li>è‡ªåŠ¨ HTTPSï¼Œè¯ä¹¦è‡ªåŠ¨æ›´æ–°</li>
</ul>
<h2 id="ç”¨æ³•">ç”¨æ³•</h2>
<ol>
<li>
<p>æŒ‰ç…§ <a href="https://caddyserver.com/docs/install">å®˜æ–¹æ–‡æ¡£</a>ï¼Œé€‰æ‹©å¯¹åº”çš„æœåŠ¡å™¨ç‰ˆæœ¬å®‰è£… Caddy</p>
</li>
<li>
<p>ç¼–å†™é…ç½®æ–‡ä»¶ï¼Œåå‘ä»£ç†è¿è¡Œåœ¨ 3000 ç«¯å£çš„æœåŠ¡</p>
</li>
</ol>
<pre><code class="language-yaml"># Caddyfile
app.domain.com {
        reverse_proxy :3000 {
                header_up Host {host} # redundant
                header_up X-Real-IP {remote}
                header_up X-Forwarded-Port {server_port} # redundant
        }
}
</code></pre>
<ol start="3">
<li>å¯åŠ¨</li>
</ol>
<pre><code class="language-shell">caddy adapt -c ./Caddyfile
caddy run
</code></pre>
<ol start="4">
<li>ä»£ç† OpenAI çš„ API æ¥å£</li>
</ol>
<pre><code class="language-yaml">openai-api-proxy.domain.com {
    reverse_proxy /* https://api.openai.com {
        header_up -*
        header_up Host api.openai.com
        header_up Authorization {http.request.header.authorization}
        header_up Content-Type {http.request.header.content-type}
        header_up X-Forwarded-Proto {scheme}
        header_up X-Forwarded-For {remote}    
    }
}
</code></pre>
<ol start="5">
<li>æ›´æ–°é…ç½®</li>
</ol>
<pre><code class="language-shell">caddy adapt -c ./Caddyfile
caddy reload
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä½¿ç”¨ Docker Compose å¿«é€Ÿéƒ¨ç½²å¸¸ç”¨çš„æœåŠ¡]]></title>
        <id>https://youking.vsh.cc/post/usefull-docker-compose-configs/</id>
        <link href="https://youking.vsh.cc/post/usefull-docker-compose-configs/">
        </link>
        <updated>2024-12-26T12:29:06.000Z</updated>
        <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<ol>
<li>æŒ‰ç…§ <a href="https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository">å®˜æ–¹æ–‡æ¡£</a> å®‰è£… docker</li>
</ol>
<pre><code class="language-shell">curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
</code></pre>
<ol start="2">
<li><a href="https://docs.portainer.io/start/install/server/docker/linux">å®‰è£…å›¾å½¢åŒ–çš„ç®¡ç†é¢æ¿ portainer</a></li>
</ol>
<h2 id="å¸¸ç”¨æŒ‡ä»¤">å¸¸ç”¨æŒ‡ä»¤</h2>
<ol>
<li>å¯åŠ¨æœåŠ¡</li>
</ol>
<pre><code class="language-shell">cd ~/apps/mysql/docker-compose.yml
docker compose up -d
</code></pre>
<ol start="2">
<li>åœç”¨æœåŠ¡</li>
</ol>
<pre><code class="language-shell">cd ~/apps/mysql/docker-compose.yml
docker down
</code></pre>
<ol start="3">
<li>æŸ¥çœ‹å®¹å™¨æ—¥å¿—</li>
</ol>
<pre><code class="language-shell">docker container ls
docker logs [id]
</code></pre>
<ol start="4">
<li>è¿›å…¥å®¹å™¨</li>
</ol>
<pre><code class="language-shell">docker exec [id] -it /bin/bash
</code></pre>
<h2 id="å¸¸ç”¨é…ç½®ä¸€è§ˆ">å¸¸ç”¨é…ç½®ä¸€è§ˆ</h2>
<p>ç¬”è€…ä¹ æƒ¯å°† Volume ç›®å½•æ”¾åˆ° <code>docker-compose.yml</code> åŒçº§ç›®å½•ä¸‹ï¼Œæ–¹ä¾¿ç®¡ç†ï¼Œå› æ­¤ä¼šä½œå½¢å¦‚ä¸‹é¢çš„é…ç½®ï¼š</p>
<pre><code class="language-yml">services:
  db:
    image: mysql:5.7
    volumes:
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/mysql/confs:/etc/mysql
</code></pre>
<h3 id="saas-dify">[SAAS] Dify</h3>
<ol>
<li><a href="https://docs.dify.ai/zh-hans/getting-started/install-self-hosted/docker-compose">éƒ¨ç½²æ–‡æ¡£</a></li>
<li>ä¿®æ”¹ <code>.env</code> æ–‡ä»¶ï¼Œéƒ¨ç½²ç›‘å¬åœ¨é 80 ç«¯å£</li>
</ol>
<pre><code class="language-env">EXPOSE_NGINX_PORT=8001
</code></pre>
<ol start="3">
<li>ä½¿ç”¨ Caddy æ–¹å‘ä»£ç†</li>
</ol>
<pre><code class="language-yml">dify.yourdomain.com {
        reverse_proxy :8001 {
                header_up Host {host} # redundant
                header_up X-Real-IP {remote}
                header_up X-Forwarded-Port {server_port} # redundant
        }
}
</code></pre>
<h3 id="saas-umami">[SAAS] Umami</h3>
<ol>
<li>é…ç½®æ–‡ä»¶</li>
</ol>
<pre><code class="language-yml"># apps/umami/docker-compose.yml
services:
  umami:
    image: ghcr.io/umami-software/umami:postgresql-latest
    ports:
      - &quot;3000:3000&quot;
    environment:
      DATABASE_URL: postgresql://umami:umami@db:5432/umami
      DATABASE_TYPE: postgresql
      APP_SECRET: replace-me-with-a-random-string
    depends_on:
      db:
        condition: service_healthy
    restart: always
    healthcheck:
      test: [&quot;CMD-SHELL&quot;, &quot;curl http://localhost:3000/api/heartbeat&quot;]
      interval: 5s
      timeout: 5s
      retries: 5
  db:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: umami
      POSTGRES_USER: umami
      POSTGRES_PASSWORD: umami
    volumes:
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/umami/data:/var/lib/postgresql/data
    restart: always
    healthcheck:
      test: [&quot;CMD-SHELL&quot;, &quot;pg_isready -U $${POSTGRES_USER} -d $${POSTGRES_DB}&quot;]
      interval: 5s
      timeout: 5s
      retries: 5
volumes:
  umami-db-data
</code></pre>
<ol start="2">
<li>ä½¿ç”¨ Caddy åå‘ä»£ç†</li>
</ol>
<pre><code class="language-yml">umami.yourdomain.com {
        reverse_proxy :3000 {
                header_up Host {host} # redundant
        }
}
</code></pre>
<h3 id="saas-flowise-ai">[SAAS] Flowise AI</h3>
<pre><code class="language-yml"># apps/flowise/docker-compose.yml
services:
    flowise:
        image: flowiseai/flowise
        restart: always
        environment:
            - PORT=${PORT}
            - CORS_ORIGINS=${CORS_ORIGINS}
            - IFRAME_ORIGINS=${IFRAME_ORIGINS}
            - FLOWISE_USERNAME=${FLOWISE_USERNAME}
            - FLOWISE_PASSWORD=${FLOWISE_PASSWORD}
            - FLOWISE_FILE_SIZE_LIMIT=${FLOWISE_FILE_SIZE_LIMIT}
            - DEBUG=${DEBUG}
            - DATABASE_PATH=${DATABASE_PATH}
            - DATABASE_TYPE=${DATABASE_TYPE}
            - DATABASE_PORT=${DATABASE_PORT}
            - DATABASE_HOST=${DATABASE_HOST}
            - DATABASE_NAME=${DATABASE_NAME}
            - DATABASE_USER=${DATABASE_USER}
            - DATABASE_PASSWORD=${DATABASE_PASSWORD}
            - DATABASE_SSL=${DATABASE_SSL}
            - DATABASE_SSL_KEY_BASE64=${DATABASE_SSL_KEY_BASE64}
            - APIKEY_PATH=${APIKEY_PATH}
            - SECRETKEY_PATH=${SECRETKEY_PATH}
            - FLOWISE_SECRETKEY_OVERWRITE=${FLOWISE_SECRETKEY_OVERWRITE}
            - LOG_LEVEL=${LOG_LEVEL}
            - LOG_PATH=${LOG_PATH}
            - BLOB_STORAGE_PATH=${BLOB_STORAGE_PATH}
            - DISABLE_FLOWISE_TELEMETRY=${DISABLE_FLOWISE_TELEMETRY}
            - MODEL_LIST_CONFIG_JSON=${MODEL_LIST_CONFIG_JSON}
        ports:
            - '${PORT}:${PORT}'
        volumes:
            - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/flowise:/root/.flowise
        entrypoint: /bin/sh -c &quot;sleep 3; flowise start&quot;
</code></pre>
<h3 id="saas-firecrawl-çˆ¬è™«">[SAAS] Firecrawl çˆ¬è™«</h3>
<ol>
<li>å…‹éš†ä»“åº“ <code>gitl clone git@github.com:mendableai/firecrawl.git</code></li>
<li>ä¿®æ”¹ <code>docker-compose.yml</code> æ–‡ä»¶</li>
</ol>
<pre><code class="language-yml">name: firecrawl

x-common-service: &amp;common-service
  build: 
    context: apps/api
    args:
      - http_proxy=http://10.74.176.8:11080
      - https_proxy=http://10.74.176.8:11080
  networks:
    - backend
  extra_hosts:
    - &quot;host.docker.internal:host-gateway&quot;

services:
  playwright-service:
    build: 
      context: apps/playwright-service-ts
      args:
        - http_proxy=http://10.74.176.8:11080
        - https_proxy=http://10.74.176.8:11080
    environment:
      - PORT=3003
      - PROXY_SERVER=${PROXY_SERVER}
      - PROXY_USERNAME=${PROXY_USERNAME}
      - PROXY_PASSWORD=${PROXY_PASSWORD}
      - BLOCK_MEDIA=${BLOCK_MEDIA}
    ports:
      - &quot;3003:3003&quot;
    networks:
      - backend

  api:
    &lt;&lt;: *common-service
    environment:
      REDIS_URL: ${REDIS_URL:-redis://redis:6379}
      REDIS_RATE_LIMIT_URL: ${REDIS_URL:-redis://redis:6379}
      PLAYWRIGHT_MICROSERVICE_URL: ${PLAYWRIGHT_MICROSERVICE_URL:-http://playwright-service:3000}
      USE_DB_AUTHENTICATION: ${USE_DB_AUTHENTICATION}
      PORT: ${PORT:-3002}
      NUM_WORKERS_PER_QUEUE: ${NUM_WORKERS_PER_QUEUE}
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      OPENAI_BASE_URL: ${OPENAI_BASE_URL}
      MODEL_NAME: ${MODEL_NAME:-gpt-4o}
      SLACK_WEBHOOK_URL: ${SLACK_WEBHOOK_URL}
      LLAMAPARSE_API_KEY: ${LLAMAPARSE_API_KEY}
      LOGTAIL_KEY: ${LOGTAIL_KEY}
      BULL_AUTH_KEY: ${BULL_AUTH_KEY}
      TEST_API_KEY: ${TEST_API_KEY}
      POSTHOG_API_KEY: ${POSTHOG_API_KEY}
      POSTHOG_HOST: ${POSTHOG_HOST}
      SUPABASE_ANON_TOKEN: ${SUPABASE_ANON_TOKEN}
      SUPABASE_URL: ${SUPABASE_URL}
      SUPABASE_SERVICE_TOKEN: ${SUPABASE_SERVICE_TOKEN}
      SCRAPING_BEE_API_KEY: ${SCRAPING_BEE_API_KEY}
      HOST: ${HOST:-0.0.0.0}
      SELF_HOSTED_WEBHOOK_URL: ${SELF_HOSTED_WEBHOOK_URL}
      LOGGING_LEVEL: ${LOGGING_LEVEL}
      FLY_PROCESS_GROUP: app
    depends_on:
      - redis
      - playwright-service
    ports:
      - &quot;3002:3002&quot;
    command: [ &quot;pnpm&quot;, &quot;run&quot;, &quot;start:production&quot; ]

  worker:
    &lt;&lt;: *common-service
    environment:
      REDIS_URL: ${REDIS_URL:-redis://redis:6379}
      REDIS_RATE_LIMIT_URL: ${REDIS_URL:-redis://redis:6379}
      PLAYWRIGHT_MICROSERVICE_URL: ${PLAYWRIGHT_MICROSERVICE_URL:-http://playwright-service:3000}
      USE_DB_AUTHENTICATION: ${USE_DB_AUTHENTICATION}
      PORT: ${PORT:-3002}
      NUM_WORKERS_PER_QUEUE: ${NUM_WORKERS_PER_QUEUE}
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      OPENAI_BASE_URL: ${OPENAI_BASE_URL}
      MODEL_NAME: ${MODEL_NAME:-gpt-4o}
      SLACK_WEBHOOK_URL: ${SLACK_WEBHOOK_URL}
      LLAMAPARSE_API_KEY: ${LLAMAPARSE_API_KEY}
      LOGTAIL_KEY: ${LOGTAIL_KEY}
      BULL_AUTH_KEY: ${BULL_AUTH_KEY}
      TEST_API_KEY: ${TEST_API_KEY}
      POSTHOG_API_KEY: ${POSTHOG_API_KEY}
      POSTHOG_HOST: ${POSTHOG_HOST}
      SUPABASE_ANON_TOKEN: ${SUPABASE_ANON_TOKEN}
      SUPABASE_URL: ${SUPABASE_URL}
      SUPABASE_SERVICE_TOKEN: ${SUPABASE_SERVICE_TOKEN}
      SCRAPING_BEE_API_KEY: ${SCRAPING_BEE_API_KEY}
      HOST: ${HOST:-0.0.0.0}
      SELF_HOSTED_WEBHOOK_URL: ${SELF_HOSTED_WEBHOOK_URL}
      LOGGING_LEVEL: ${LOGGING_LEVEL}
      FLY_PROCESS_GROUP: worker
    depends_on:
      - redis
      - playwright-service
      - api
    command: [ &quot;pnpm&quot;, &quot;run&quot;, &quot;workers&quot; ]

  redis:
    image: redis:alpine
    networks:
      - backend
    command: redis-server --bind 0.0.0.0

networks:
  backend:
    driver: bridge
</code></pre>
<ol start="3">
<li>æ·»åŠ ç¯å¢ƒå˜é‡æ–‡ä»¶</li>
</ol>
<ul>
<li>å†…ç½‘ç¯å¢ƒé…Œæƒ…é…ç½® <code>PROXY_SERVER</code> ä»£ç†è®¿é—®</li>
</ul>
<pre><code class="language-txt"># ===== Required ENVS ======
NUM_WORKERS_PER_QUEUE=8 
PORT=3002
HOST=0.0.0.0
REDIS_URL=redis://redis:6379 #for self-hosting using docker, use redis://redis:6379. For running locally, use redis://localhost:6379
REDIS_RATE_LIMIT_URL=redis://redis:6379 #for self-hosting using docker, use redis://redis:6379. For running locally, use redis://localhost:6379
PLAYWRIGHT_MICROSERVICE_URL=http://172.28.214.245:3003/scrape

## To turn on DB authentication, you need to set up supabase.
USE_DB_AUTHENTICATION=false

# ===== Optional ENVS ======

# Supabase Setup (used to support DB authentication, advanced logging, etc.)
SUPABASE_ANON_TOKEN= 
SUPABASE_URL= 
SUPABASE_SERVICE_TOKEN=

# Other Optionals
# use if you've set up authentication and want to test with a real API key
TEST_API_KEY=
# set if you'd like to test the scraping rate limit
RATE_LIMIT_TEST_API_KEY_SCRAPE=
# set if you'd like to test the crawling rate limit
RATE_LIMIT_TEST_API_KEY_CRAWL=
# set if you'd like to use scraping Be to handle JS blocking
SCRAPING_BEE_API_KEY=
# add for LLM dependednt features (image alt generation, etc.)
OPENAI_API_KEY=
BULL_AUTH_KEY=@
# use if you're configuring basic logging with logtail
LOGTAIL_KEY=
# set if you have a llamaparse key you'd like to use to parse pdfs
LLAMAPARSE_API_KEY=
# set if you'd like to send slack server health status messages
SLACK_WEBHOOK_URL=
# set if you'd like to send posthog events like job logs
POSTHOG_API_KEY=
# set if you'd like to send posthog events like job logs
POSTHOG_HOST=

STRIPE_PRICE_ID_STANDARD=
STRIPE_PRICE_ID_SCALE=
STRIPE_PRICE_ID_STARTER=
STRIPE_PRICE_ID_HOBBY=
STRIPE_PRICE_ID_HOBBY_YEARLY=
STRIPE_PRICE_ID_STANDARD_NEW=
STRIPE_PRICE_ID_STANDARD_NEW_YEARLY=
STRIPE_PRICE_ID_GROWTH=
STRIPE_PRICE_ID_GROWTH_YEARLY=

HYPERDX_API_KEY=
HDX_NODE_BETA_MODE=1

# set if you'd like to use the fire engine closed beta
FIRE_ENGINE_BETA_URL=

# Proxy Settings for Playwright (Alternative you can can use a proxy service like oxylabs, which rotates IPs for you on every request)
PROXY_SERVER=
PROXY_USERNAME=
PROXY_PASSWORD=
# set if you'd like to block media requests to save proxy bandwidth
BLOCK_MEDIA=

# Set this to the URL of your webhook when using the self-hosted version of FireCrawl
SELF_HOSTED_WEBHOOK_URL=

# Resend API Key for transactional emails
RESEND_API_KEY=

# LOGGING_LEVEL determines the verbosity of logs that the system will output.
# Available levels are:
# NONE - No logs will be output.
# ERROR - For logging error messages that indicate a failure in a specific operation.
# WARN - For logging potentially harmful situations that are not necessarily errors.
# INFO - For logging informational messages that highlight the progress of the application.
# DEBUG - For logging detailed information on the flow through the system, primarily used for debugging.
# TRACE - For logging more detailed information than the DEBUG level.
# Set LOGGING_LEVEL to one of the above options to control logging output.
LOGGING_LEVEL=DEBUG
</code></pre>
<h3 id="æ•°æ®åº“-mysql">[æ•°æ®åº“] Mysql</h3>
<pre><code class="language-yml"># apps/mysql/docker-compose.yml
services:
  db:
    image: mysql:5.7
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: xxx_PASSWORD
    volumes:
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/mysql/confs:/etc/mysql
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/mysql/logs:/var/log/mysql
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/mysql/data:/var/lib/mysql
    ports:
      - 3306:3306
</code></pre>
<h3 id="æ•°æ®åº“-mongodb">[æ•°æ®åº“] MongoDB</h3>
<pre><code class="language-yml"># apps/mongo/docker-compose.yml
services:
  mongo:
    image: 'mongo:7.0.5'
    ports:
      - 27017:27017
    volumes:
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/mongo:/var/lib/mongodb/data

  mongo-express:
    image: 'mongo-express:1.0.2'
    ports:
      - 8081:8081
    environment:
      ME_CONFIG_BASICAUTH_USERNAME: admin
      ME_CONFIG_BASICAUTH_PASSWORD: admin
</code></pre>
<h3 id="æ•°æ®åº“-milvus">[æ•°æ®åº“] Milvus</h3>
<pre><code class="language-yml"># apps/milvus/docker-compose.yml
services:
  etcd:
    container_name: milvus-etcd
    restart: always
    image: quay.io/coreos/etcd:v3.5.14
    environment:
      - ETCD_AUTO_COMPACTION_MODE=revision
      - ETCD_AUTO_COMPACTION_RETENTION=1000
      - ETCD_QUOTA_BACKEND_BYTES=4294967296
      - ETCD_SNAPSHOT_COUNT=50000
    volumes:
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/etcd:/etcd
    command: etcd -advertise-client-urls=http://127.0.0.1:2379 -listen-client-urls http://0.0.0.0:2379 --data-dir /etcd
    healthcheck:
      test: [&quot;CMD&quot;, &quot;etcdctl&quot;, &quot;endpoint&quot;, &quot;health&quot;]
      interval: 30s
      timeout: 20s
      retries: 3

  minio:
    container_name: milvus-minio
    restart: always
    image: minio/minio:RELEASE.2023-03-20T20-16-18Z
    environment:
      MINIO_ACCESS_KEY: minioadmin
      MINIO_SECRET_KEY: minioadmin
    ports:
      - &quot;9001:9001&quot;
      - &quot;19000:9000&quot;
    volumes:
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/minio:/minio_data
    command: minio server /minio_data --console-address &quot;:9001&quot;
    healthcheck:
      test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:9000/minio/health/live&quot;]
      interval: 30s
      timeout: 20s
      retries: 3

  standalone:
    container_name: milvus-standalone
    image: milvusdb/milvus:v2.4.11
    command: [&quot;milvus&quot;, &quot;run&quot;, &quot;standalone&quot;]
    security_opt:
    - seccomp:unconfined
    environment:
      ETCD_ENDPOINTS: etcd:2379
      MINIO_ADDRESS: minio:9000
    volumes:
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/milvus:/var/lib/milvus
    healthcheck:
      test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:9091/healthz&quot;]
      interval: 30s
      start_period: 90s
      timeout: 20s
      retries: 3
    ports:
      - &quot;19530:19530&quot;
      - &quot;9091:9091&quot;
    depends_on:
      - &quot;etcd&quot;
      - &quot;minio&quot;
  attu:
    container_name: attu
    image: zilliz/attu:latest
    environment:
      MILVUS_URL: milvus-standalone:19530
    ports:
      - &quot;9002:3000&quot;
    depends_on:
      - &quot;standalone&quot;

networks:
  default:
    name: milvus
</code></pre>
<h3 id="æ•°æ®åº“-neo4j">[æ•°æ®åº“] Neo4j</h3>
<pre><code class="language-yml"># apps/neo4j/docker-compose.yml
services:
  neo4j:
    image: neo4j:4.4.38
    restart: always
    environment:
      - NEO4J_AUTH=neo4j/neo4j_passowrd
      - NEO4J_apoc_export_file_enabled=true
      - NEO4J_apoc_import_file_enabled=true
      - NEO4J_apoc_import_file_use__neo4j__config=true
      - NEO4J_dbms_connector_bolt_listen__address=7688
      - NEO4J_dbms_connector_bolt_advertised__address=7688
      - NEO4J_PLUGINS=[&quot;apoc&quot;, &quot;graph-data-science&quot;]
    volumes:
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/neo4j/data:/data
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/neo4j/logs:/logs
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/neo4j/config:/config
      - ${DOCKER_VOLUME_DIRECTORY:-.}/volumes/neo4j/plugins:/plugins
    ports: 
      - 7474:7474
      - 7687:7687
</code></pre>
<h3 id="ä¸­é—´ä»¶-kafka">[ä¸­é—´ä»¶] Kafka</h3>
<pre><code class="language-yml"># apps/kafka/docker-compose.yml
services:
  zookeeper:
    image: 'bitnami/zookeeper:latest'
    restart: always
    ports:
      - 2181:2181
    environment:
      ALLOW_ANONYMOUS_LOGIN: &quot;yes&quot;
  kafka:
    image: 'bitnami/kafka:latest'
    restart: always
    ports:
      - 9092:9092
    environment:
      KAFKA_CFG_ZOOKEEPER_CONNECT: zookeeper:2181
      ALLOW_PLAINTEXT_LISTENER: &quot;yes&quot;
      KAFKA_ADVERTISED_HOST_NAME: 101.43.207.38                  ## ä¿®æ”¹:å®¿ä¸»æœºIP
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://101.43.207.38:9092    ## ä¿®æ”¹:å®¿ä¸»æœºIP
      KAFKA_ZOOKEEPER_CONNECT: &quot;101.43.207.38:2181&quot;
      KAFKA_ADVERTISED_PORT: 9092
      KAFKA_BROKER_ID: 1
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
    depends_on:
      - zookeeper
  kafka-ui:
    container_name: kafka-ui
    image: provectuslabs/kafka-ui:latest
    ports:
      - 8888:8080
    environment:
      - KAFKA_CLUSTERS_0_NAME=dev_cluster
      - KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS=101.43.207.38:9092
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[åŸºäº truboã€pnpmã€nextjsã€tsup çš„ monorepo æ”¾é¢˜]]></title>
        <id>https://youking.vsh.cc/post/turbo-monorepo-buffet/</id>
        <link href="https://youking.vsh.cc/post/turbo-monorepo-buffet/">
        </link>
        <updated>2024-12-25T07:23:59.000Z</updated>
        <content type="html"><![CDATA[<h2 id="æ–¹æ¡ˆ-ä¼˜åŠ¿">æ–¹æ¡ˆ &amp; ä¼˜åŠ¿</h2>
<p>æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li>ä½¿ç”¨ <a href="https://turbo.build/repo/docs">turbo</a> è¿›è¡Œä¾èµ–ä»»åŠ¡æ„å»ºï¼›</li>
<li>ä½¿ç”¨ <a href="https://pnpm.io/installation">pnpm</a> å¿«é€Ÿé«˜æ•ˆçš„é“¾æ¥å¤šä¸ª Packageï¼›</li>
<li>ä½¿ç”¨ <a href="https://nextjs.org/docs">Nextjs</a> å…¨æ–¹ä½æå‡ React å¼€å‘ä½“éªŒï¼Œå¹¶æä¾›è½»é‡çº§çš„ API æœåŠ¡ï¼›</li>
<li>ä½¿ç”¨ <a href="https://tsup.egoist.dev/#install">tsup</a> å¤„ç†ç‰¹æ®Šåœºæ™¯çš„æ‰“åŒ…æ„å»ºï¼Œå¦‚æ„å»ºç¬¦åˆ commonjs è§„èŒƒçš„åŒ…ï¼ˆPackageï¼‰æˆ–æ†ç»‘æ–‡ä»¶ï¼ˆBundle Fileï¼‰ç­‰ã€‚</li>
</ul>
<p>æ¨¡ç‰ˆå¯ä»¥ç›´æ¥é€šè¿‡ turbo çš„ç”Ÿæˆï¼š</p>
<pre><code class="language-shell">pnpm dlx create-turbo@latest
</code></pre>
<h2 id="å…³é”®è¡ŒåŠ¨">å…³é”®è¡ŒåŠ¨</h2>
<h3 id="ä½¿ç”¨-turbo-è¿›è¡Œä¾èµ–ä»»åŠ¡æ„å»º">ä½¿ç”¨ turbo è¿›è¡Œä¾èµ–ä»»åŠ¡æ„å»º</h3>
<p>Nodejs çš„ä¾èµ–æ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ç»“æ„ï¼Œä½¿ç”¨ pnpm ä»¥ monorepo çš„æ–¹å¼ç»„ç»‡æºä»£ç ä¸å¯é¿å…çš„å‡ºç°ä¾èµ–æ„å»ºé—®é¢˜ï¼Œä»¥ä¸‹æ–¹ç›®å½•ä»¥åŠå½¢æˆçš„ä¾èµ–å…³ç³»ä¸ºä¾‹ï¼š</p>
<ul>
<li>æ„å»º <code>apps/api</code> ä¹‹å‰å…ˆè¦æ„å»º <code>packages/b</code></li>
<li>ä¿®æ”¹ <code>packages/b</code> è¦é‡æ–°æ„å»º <code>apps/api</code></li>
</ul>
<pre><code>project
â”œâ”€â”€ apps
â”‚   â”œâ”€â”€ api
â”‚   â””â”€â”€ web
â”œâ”€â”€ package.json
â”œâ”€â”€ pnpm-lock.yaml
â”œâ”€â”€ pnpm-workspace.yaml
â”œâ”€â”€ packages
â”‚   â”œâ”€â”€ a
â”‚   â””â”€â”€ b
â””â”€â”€ turbo.json

# ä¾èµ–å…³ç³»
web/node_modules/a/node_modues/b
api/node_modules/a/node_modues/b
</code></pre>
<p>turbo è§£å†³æ„å»ºä¾èµ–é—®é¢˜ä»…éœ€æ‰§è¡Œ <code>trubo run build --filter=api...</code> è¿™ä¸€ç®€å•å‘½ä»¤ã€‚</p>
<h3 id="ä½¿ç”¨-tsup-å¤„ç†ç‰¹æ®Šåœºæ™¯çš„æ‰“åŒ…æ„å»º">ä½¿ç”¨ tsup å¤„ç†ç‰¹æ®Šåœºæ™¯çš„æ‰“åŒ…æ„å»º</h3>
<p>éœ€è¦å•ç‹¬æ‰“åŒ…çš„åœºæ™¯å¾ˆå¤šï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»å…¶ä¸­å¸¸è§çš„ä¸¤ç§ï¼Œä¹Ÿæ˜¯ç¬”è€…ç»å¸¸ä½¿ç”¨ tsup è¿›è¡Œå¤„ç†çš„ï¼š</p>
<ul>
<li>éœ€è¦ç‹¬ç«‹å‘å¸ƒã€éƒ¨ç½²çš„ JS Bundle æ–‡ä»¶ï¼Œå¦‚ SDK ç­‰ï¼›</li>
<li>é‡åˆ°å¿…é¡»ä½¿ç”¨çš„æ—§ç‰ˆæœ¬ Packageï¼Œè¦æ±‚å¿…é¡»åœ¨ Commonjs è§„èŒƒçš„ä¸Šä¸‹æ–‡ï¼›</li>
</ul>
<h4 id="ç«å“å¯¹æ¯”">ç«å“å¯¹æ¯”</h4>
<table>
<thead>
<tr>
<th>å¯¹æ¯”é¡¹</th>
<th>TSUP</th>
<th>Vite</th>
<th>Webpack</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ„å»ºé€Ÿåº¦</td>
<td>åŸºäº Esbuildï¼Œé€Ÿåº¦æå¿«ï¼Œå¤„ç†ä¸­å°é¡¹ç›®ç¬é—´å®Œæˆ</td>
<td>å¼€å‘æ¨¡å¼ä¸‹å†·å¯åŠ¨å¿«ï¼Œåˆ©ç”¨æµè§ˆå™¨åŸç”Ÿ ES æ¨¡å—ï¼Œçƒ­æ›´æ–°è¿…é€Ÿ</td>
<td>ç›¸å¯¹è¾ƒæ…¢ï¼Œéœ€è¦åˆ†ææ•´ä¸ªé¡¹ç›®æ¨¡å—ï¼Œæœ‰ä¼˜åŒ–ç­–ç•¥å¯æå‡é€Ÿåº¦</td>
</tr>
<tr>
<td>å¼€å‘ä½“éªŒ</td>
<td>ä¾§é‡äºæ‰“åŒ…ï¼Œç®€å•ç›´æ¥ï¼Œå¼€å‘æœåŠ¡å™¨åŠŸèƒ½å°‘</td>
<td>çƒ­æ›´æ–°åŠŸèƒ½å¼ºå¤§ï¼Œå¼€å‘æœåŠ¡å™¨æ”¯æŒå¤šç§é…ç½®ï¼Œå¦‚ä»£ç†ï¼Œæ–¹ä¾¿å¤„ç†è·¨åŸŸ</td>
<td>é…ç½®æ’ä»¶å’Œå¼€å‘æœåŠ¡å™¨åä½“éªŒä¸é”™ï¼Œä½†é…ç½®å¤æ‚ï¼Œå­¦ä¹ æˆæœ¬é«˜</td>
</tr>
<tr>
<td>ç”Ÿæ€ç³»ç»Ÿå’Œæ’ä»¶æ”¯æŒ</td>
<td>ç”Ÿæ€ç³»ç»Ÿç›¸å¯¹å°ï¼Œæ’ä»¶æ”¯æŒæœ‰é™ï¼Œèƒ½æ»¡è¶³åŸºæœ¬æ‰“åŒ…éœ€æ±‚</td>
<td>ç”Ÿæ€ç³»ç»Ÿä¸æ–­å£®å¤§ï¼Œé’ˆå¯¹ä¸åŒæ¡†æ¶æœ‰æ’ä»¶ï¼Œè¿˜æœ‰æ€§èƒ½ä¼˜åŒ–å’Œå¼€å‘ä½“éªŒç›¸å…³æ’ä»¶</td>
<td>ç”Ÿæ€ç³»ç»Ÿåºå¤§ï¼Œå‡ ä¹èƒ½æ‰¾åˆ°æ»¡è¶³ä»»ä½•éœ€æ±‚çš„æ’ä»¶</td>
</tr>
<tr>
<td>é€‚ç”¨åœºæ™¯</td>
<td>é€‚ç”¨äºç®€å• TypeScript é¡¹ç›®ï¼Œå¦‚æ³¨é‡å¿«é€Ÿæ‰“åŒ…çš„å·¥å…·åº“ã€å°å‹å‘½ä»¤è¡Œå·¥å…·ç­‰</td>
<td>ç°ä»£å‰ç«¯å¼€å‘ï¼ŒåŸºäº Vueã€React ç­‰æ¡†æ¶çš„åº”ç”¨ï¼Œå¯¹å¼€å‘æ•ˆç‡å’Œçƒ­æ›´æ–°é€Ÿåº¦è¦æ±‚é«˜</td>
<td>å¤æ‚å¤§å‹å‰ç«¯é¡¹ç›®ï¼Œéœ€ç²¾ç»†æ§åˆ¶æ‰“åŒ…ã€æ·±åº¦ä¼˜åŒ–å’Œå¤§é‡ä½¿ç”¨æ’ä»¶ï¼Œå¯¹æ—§æµè§ˆå™¨å…¼å®¹æ€§è¦æ±‚é«˜</td>
</tr>
</tbody>
</table>
<h4 id="ç”Ÿæˆ-commonjs-è§„èŒƒçš„-package">ç”Ÿæˆ Commonjs è§„èŒƒçš„ Package</h4>
<pre><code>project
â”œâ”€â”€ packages
â”‚   â””â”€â”€ cjs-pkg
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â””â”€â”€ tsup.config.ts
â””â”€â”€ turbo.json
</code></pre>
<p>å¦‚ä»¥ä¸Šçš„ç›®å½•ç»“æ„æ‰€ç¤ºï¼Œä½¿ç”¨ tsup å•ç‹¬ä¸º <code>cjs-pkg</code> ç”Ÿæˆ Commonjs è§„èŒƒçš„ä»£ç ï¼š</p>
<ol>
<li>å®šä¹‰ Commonjs çš„ Package</li>
</ol>
<pre><code class="language-json">// project/packages/cjs-pkg/package.json
{
  &quot;name&quot;: &quot;vector-store&quot;,
  &quot;type&quot;: &quot;commonjs&quot;,
  &quot;main&quot;: &quot;./dist/index.js&quot;,
  &quot;types&quot;: &quot;./src/index.ts&quot;,
  &quot;scripts&quot;: {
    &quot;dev&quot;: &quot;tsup --watch&quot;,
    &quot;build&quot;: &quot;tsup&quot;,
  },
  &quot;devDependencies&quot;: {
      &quot;tsup&quot;: &quot;^8.3.0&quot;,
  }
}
</code></pre>
<ol start="2">
<li>ç¼–å†™ tsup çš„é…ç½®æ–‡ä»¶</li>
</ol>
<pre><code class="language-typescript">// // project/packages/cjs-pkg/tsup.config.ts
import { defineConfig, Options } from 'tsup'

export default defineConfig((options: Options) =&gt; ({
  entry: ['src/index.ts'],
  format: ['cjs'],
  target: 'node18',
  dts: false,
  shims: true,
  silent: true,
  sourcemap: true,
  ...options,
}))
</code></pre>
<ol start="3">
<li>è¿è¡Œ dev/build å‘½ä»¤ç¼–è¯‘è¾“å‡ºç»“æœ</li>
</ol>
<h4 id="ä½¿ç”¨-tsup-æ‰“åŒ…æ„å»º-sdk">ä½¿ç”¨ tsup æ‰“åŒ…æ„å»º SDK</h4>
<p>ä¾‹å¦‚åœ¨ Shopify çš„å¼€å‘åœºæ™¯ä¸­ï¼Œé€šå¸¸ä¼šæä¾›ä¸€ä¸ª JS çš„ SDK åŒ…åµŒå…¥å•†åº—ç½‘ç«™ï¼Œä½¿ç”¨ tsup å¯ä»¥ç®€å•å¤„ç†è¿™ç§é—®é¢˜ï¼›</p>
<ol>
<li>ä»¥ä¸‹é¢çš„ç›®å½•ç»“æ„ä¸ºä¾‹ï¼ŒæœŸæœ›æŠŠ <code>packages/sdk</code> æ‰“åŒ…ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ iife æ–‡ä»¶</li>
</ol>
<pre><code>project
â”œâ”€â”€ packages
â”‚   â””â”€â”€ sdk
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â””â”€â”€ tsup.config.ts
â””â”€â”€ turbo.json
</code></pre>
<ol start="2">
<li>ç¼–å†™ tsup é…ç½®æ–‡ä»¶</li>
</ol>
<pre><code class="language-typescript">// å¯¼å…¥ç¯å¢ƒå˜é‡
import 'dotenv/config';

export default defineConfig((options: Options) =&gt; ({
  entry: {
    index: './src/index.ts',
    seed: './src/seed.ts'
  },
  outDir: './dist,
  metafile: true,
  format: ['iife'],
  esbuildOptions(options) {
    options.banner = {
      js: '&quot;use client&quot;'
    };
  },
  env: {
    NODE_ENV: 'production',
  },
  minify: true,
  ...options
}));
</code></pre>
<p>tsup çš„æ‰“åŒ…æ–¹æ¡ˆå¯ä»¥ Cover ä½ç¬”è€…çš„è¿™ä¸¤ç§ç»å¸¸ç”¨åˆ°çš„åœºæ™¯ï¼Œå¦‚æœæœ‰è¿›ä¸€æ­¥éœ€è¦å®šåˆ¶çš„æ‰“åŒ…æ–¹æ¡ˆï¼Œå¯ä»¥è€ƒè™‘å¼•å…¥ Viteã€Webpackã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å…³äº]]></title>
        <id>https://youking.vsh.cc/post/about/</id>
        <link href="https://youking.vsh.cc/post/about/">
        </link>
        <updated>2019-01-25T11:09:48.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤</p>
</blockquote>
<h2 id="å…³äºæœ¬ç«™">ğŸ  å…³äºæœ¬ç«™</h2>
<p>èšç„¦äºå‰ç«¯é¢†åŸŸçš„ç‹¬ç«‹å¼€å‘</p>
<h2 id="åšä¸»æ˜¯è°">ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°</h2>
<p>æ— ä¸šæ¸¸æ°‘ï¼Œå…¨çƒåº¦å‡</p>
<h2 id="å…´è¶£çˆ±å¥½">â›¹ å…´è¶£çˆ±å¥½</h2>
<ol>
<li>Golden Cat</li>
<li>RTT æ¸¸æˆ</li>
<li>å•æ¿æ»‘é›ª</li>
</ol>
<h2 id="è”ç³»æˆ‘å‘€">ğŸ“¬ è”ç³»æˆ‘å‘€</h2>
<p>whistleryz@gmail.com</p>
]]></content>
    </entry>
</feed>